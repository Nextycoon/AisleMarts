{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":117},"end":{"line":5,"column":36,"index":153}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":154},"end":{"line":6,"column":39,"index":193}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useCommerceEvents = useCommerceEvents;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _expoConstants = require(_dependencyMap[1], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  /**\n   * Phase 3 Commerce Tracking Hook\n   * Tracks story impressions, CTAs, and purchases for affiliate attribution\n   */\n\n  function useCommerceEvents(userId) {\n    const getBaseUrl = () => {\n      return Constants.default.expoConfig?.extra?.backendUrl || process.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n    };\n    const trackImpression = (0, _react.useCallback)(async (storyId, userIdOverride) => {\n      try {\n        const response = await fetch(`${getBaseUrl()}/api/track/impression`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            storyId,\n            userId: userIdOverride || userId\n          })\n        });\n        if (!response.ok) {\n          console.warn('Failed to track impression:', response.status);\n        } else {\n          console.log(`✅ Impression tracked: ${storyId}`);\n        }\n      } catch (error) {\n        console.error('Error tracking impression:', error);\n      }\n    }, [userId]);\n    const trackCTA = (0, _react.useCallback)(async (storyId, productId, userIdOverride) => {\n      try {\n        const response = await fetch(`${getBaseUrl()}/api/track/cta`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            storyId,\n            productId,\n            userId: userIdOverride || userId\n          })\n        });\n        if (!response.ok) {\n          console.warn('Failed to track CTA:', response.status);\n        } else {\n          console.log(`✅ CTA tracked: ${storyId} -> ${productId}`);\n        }\n      } catch (error) {\n        console.error('Error tracking CTA:', error);\n      }\n    }, [userId]);\n    const trackPurchase = (0, _react.useCallback)(async (orderId, productId, amount, currency, referrerStoryId, userIdOverride) => {\n      try {\n        const response = await fetch(`${getBaseUrl()}/api/track/purchase`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            orderId,\n            userId: userIdOverride || userId,\n            productId,\n            amount,\n            currency,\n            referrerStoryId\n          })\n        });\n        if (!response.ok) {\n          console.warn('Failed to track purchase:', response.status);\n          return {\n            ok: false\n          };\n        }\n        const result = await response.json();\n        console.log(`✅ Purchase tracked: ${orderId} -> Commission: $${result.commission} to creator: ${result.creatorId}`);\n        return result;\n      } catch (error) {\n        console.error('Error tracking purchase:', error);\n        return {\n          ok: false\n        };\n      }\n    }, [userId]);\n    return {\n      trackImpression,\n      trackCTA,\n      trackPurchase\n    };\n  }\n});","lineCount":106,"map":[[12,2,21,0,"exports"],[12,9,21,0],[12,10,21,0,"useCommerceEvents"],[12,27,21,0],[12,30,21,0,"useCommerceEvents"],[12,47,21,0],[13,2,5,0],[13,6,5,0,"_react"],[13,12,5,0],[13,15,5,0,"require"],[13,22,5,0],[13,23,5,0,"_dependencyMap"],[13,37,5,0],[14,2,6,0],[14,6,6,0,"_expoConstants"],[14,20,6,0],[14,23,6,0,"require"],[14,30,6,0],[14,31,6,0,"_dependencyMap"],[14,45,6,0],[15,2,6,0],[15,6,6,0,"Constants"],[15,15,6,0],[15,18,6,0,"_interopDefault"],[15,33,6,0],[15,34,6,0,"_expoConstants"],[15,48,6,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[21,2,21,7],[21,11,21,16,"useCommerceEvents"],[21,28,21,33,"useCommerceEvents"],[21,29,21,34,"userId"],[21,35,21,49],[21,37,21,70],[22,4,22,2],[22,10,22,8,"getBaseUrl"],[22,20,22,18],[22,23,22,21,"getBaseUrl"],[22,24,22,21],[22,29,22,27],[23,6,23,4],[23,13,23,11,"Constants"],[23,22,23,20],[23,23,23,20,"default"],[23,30,23,20],[23,31,23,21,"expoConfig"],[23,41,23,31],[23,43,23,33,"extra"],[23,48,23,38],[23,50,23,40,"backendUrl"],[23,60,23,50],[23,64,23,54,"process"],[23,71,23,61],[23,72,23,62,"env"],[23,75,23,65],[23,76,23,66,"EXPO_PUBLIC_BACKEND_URL"],[23,99,23,89],[23,103,23,93],[23,126,23,116],[24,4,24,2],[24,5,24,3],[25,4,26,2],[25,10,26,8,"trackImpression"],[25,25,26,23],[25,28,26,26],[25,32,26,26,"useCallback"],[25,38,26,37],[25,39,26,37,"useCallback"],[25,50,26,37],[25,52,26,38],[25,59,26,45,"storyId"],[25,66,26,60],[25,68,26,62,"userIdOverride"],[25,82,26,85],[25,87,26,90],[26,6,27,4],[26,10,27,8],[27,8,28,6],[27,14,28,12,"response"],[27,22,28,20],[27,25,28,23],[27,31,28,29,"fetch"],[27,36,28,34],[27,37,28,35],[27,40,28,38,"getBaseUrl"],[27,50,28,48],[27,51,28,49],[27,52,28,50],[27,75,28,73],[27,77,28,75],[28,10,29,8,"method"],[28,16,29,14],[28,18,29,16],[28,24,29,22],[29,10,30,8,"headers"],[29,17,30,15],[29,19,30,17],[30,12,31,10],[30,26,31,24],[30,28,31,26],[31,10,32,8],[31,11,32,9],[32,10,33,8,"body"],[32,14,33,12],[32,16,33,14,"JSON"],[32,20,33,18],[32,21,33,19,"stringify"],[32,30,33,28],[32,31,33,29],[33,12,34,10,"storyId"],[33,19,34,17],[34,12,35,10,"userId"],[34,18,35,16],[34,20,35,18,"userIdOverride"],[34,34,35,32],[34,38,35,36,"userId"],[35,10,36,8],[35,11,36,9],[36,8,37,6],[36,9,37,7],[36,10,37,8],[37,8,39,6],[37,12,39,10],[37,13,39,11,"response"],[37,21,39,19],[37,22,39,20,"ok"],[37,24,39,22],[37,26,39,24],[38,10,40,8,"console"],[38,17,40,15],[38,18,40,16,"warn"],[38,22,40,20],[38,23,40,21],[38,52,40,50],[38,54,40,52,"response"],[38,62,40,60],[38,63,40,61,"status"],[38,69,40,67],[38,70,40,68],[39,8,41,6],[39,9,41,7],[39,15,41,13],[40,10,42,8,"console"],[40,17,42,15],[40,18,42,16,"log"],[40,21,42,19],[40,22,42,20],[40,47,42,45,"storyId"],[40,54,42,52],[40,56,42,54],[40,57,42,55],[41,8,43,6],[42,6,44,4],[42,7,44,5],[42,8,44,6],[42,15,44,13,"error"],[42,20,44,18],[42,22,44,20],[43,8,45,6,"console"],[43,15,45,13],[43,16,45,14,"error"],[43,21,45,19],[43,22,45,20],[43,50,45,48],[43,52,45,50,"error"],[43,57,45,55],[43,58,45,56],[44,6,46,4],[45,4,47,2],[45,5,47,3],[45,7,47,5],[45,8,47,6,"userId"],[45,14,47,12],[45,15,47,13],[45,16,47,14],[46,4,49,2],[46,10,49,8,"trackCTA"],[46,18,49,16],[46,21,49,19],[46,25,49,19,"useCallback"],[46,31,49,30],[46,32,49,30,"useCallback"],[46,43,49,30],[46,45,49,31],[46,52,49,38,"storyId"],[46,59,49,53],[46,61,49,55,"productId"],[46,70,49,73],[46,72,49,75,"userIdOverride"],[46,86,49,98],[46,91,49,103],[47,6,50,4],[47,10,50,8],[48,8,51,6],[48,14,51,12,"response"],[48,22,51,20],[48,25,51,23],[48,31,51,29,"fetch"],[48,36,51,34],[48,37,51,35],[48,40,51,38,"getBaseUrl"],[48,50,51,48],[48,51,51,49],[48,52,51,50],[48,68,51,66],[48,70,51,68],[49,10,52,8,"method"],[49,16,52,14],[49,18,52,16],[49,24,52,22],[50,10,53,8,"headers"],[50,17,53,15],[50,19,53,17],[51,12,54,10],[51,26,54,24],[51,28,54,26],[52,10,55,8],[52,11,55,9],[53,10,56,8,"body"],[53,14,56,12],[53,16,56,14,"JSON"],[53,20,56,18],[53,21,56,19,"stringify"],[53,30,56,28],[53,31,56,29],[54,12,57,10,"storyId"],[54,19,57,17],[55,12,58,10,"productId"],[55,21,58,19],[56,12,59,10,"userId"],[56,18,59,16],[56,20,59,18,"userIdOverride"],[56,34,59,32],[56,38,59,36,"userId"],[57,10,60,8],[57,11,60,9],[58,8,61,6],[58,9,61,7],[58,10,61,8],[59,8,63,6],[59,12,63,10],[59,13,63,11,"response"],[59,21,63,19],[59,22,63,20,"ok"],[59,24,63,22],[59,26,63,24],[60,10,64,8,"console"],[60,17,64,15],[60,18,64,16,"warn"],[60,22,64,20],[60,23,64,21],[60,45,64,43],[60,47,64,45,"response"],[60,55,64,53],[60,56,64,54,"status"],[60,62,64,60],[60,63,64,61],[61,8,65,6],[61,9,65,7],[61,15,65,13],[62,10,66,8,"console"],[62,17,66,15],[62,18,66,16,"log"],[62,21,66,19],[62,22,66,20],[62,40,66,38,"storyId"],[62,47,66,45],[62,54,66,52,"productId"],[62,63,66,61],[62,65,66,63],[62,66,66,64],[63,8,67,6],[64,6,68,4],[64,7,68,5],[64,8,68,6],[64,15,68,13,"error"],[64,20,68,18],[64,22,68,20],[65,8,69,6,"console"],[65,15,69,13],[65,16,69,14,"error"],[65,21,69,19],[65,22,69,20],[65,43,69,41],[65,45,69,43,"error"],[65,50,69,48],[65,51,69,49],[66,6,70,4],[67,4,71,2],[67,5,71,3],[67,7,71,5],[67,8,71,6,"userId"],[67,14,71,12],[67,15,71,13],[67,16,71,14],[68,4,73,2],[68,10,73,8,"trackPurchase"],[68,23,73,21],[68,26,73,24],[68,30,73,24,"useCallback"],[68,36,73,35],[68,37,73,35,"useCallback"],[68,48,73,35],[68,50,73,36],[68,57,74,4,"orderId"],[68,64,74,19],[68,66,75,4,"productId"],[68,75,75,21],[68,77,76,4,"amount"],[68,83,76,18],[68,85,77,4,"currency"],[68,93,77,20],[68,95,78,4,"referrerStoryId"],[68,110,78,28],[68,112,79,4,"userIdOverride"],[68,126,79,27],[68,131,80,7],[69,6,81,4],[69,10,81,8],[70,8,82,6],[70,14,82,12,"response"],[70,22,82,20],[70,25,82,23],[70,31,82,29,"fetch"],[70,36,82,34],[70,37,82,35],[70,40,82,38,"getBaseUrl"],[70,50,82,48],[70,51,82,49],[70,52,82,50],[70,73,82,71],[70,75,82,73],[71,10,83,8,"method"],[71,16,83,14],[71,18,83,16],[71,24,83,22],[72,10,84,8,"headers"],[72,17,84,15],[72,19,84,17],[73,12,85,10],[73,26,85,24],[73,28,85,26],[74,10,86,8],[74,11,86,9],[75,10,87,8,"body"],[75,14,87,12],[75,16,87,14,"JSON"],[75,20,87,18],[75,21,87,19,"stringify"],[75,30,87,28],[75,31,87,29],[76,12,88,10,"orderId"],[76,19,88,17],[77,12,89,10,"userId"],[77,18,89,16],[77,20,89,18,"userIdOverride"],[77,34,89,32],[77,38,89,36,"userId"],[77,44,89,42],[78,12,90,10,"productId"],[78,21,90,19],[79,12,91,10,"amount"],[79,18,91,16],[80,12,92,10,"currency"],[80,20,92,18],[81,12,93,10,"referrerStoryId"],[82,10,94,8],[82,11,94,9],[83,8,95,6],[83,9,95,7],[83,10,95,8],[84,8,97,6],[84,12,97,10],[84,13,97,11,"response"],[84,21,97,19],[84,22,97,20,"ok"],[84,24,97,22],[84,26,97,24],[85,10,98,8,"console"],[85,17,98,15],[85,18,98,16,"warn"],[85,22,98,20],[85,23,98,21],[85,50,98,48],[85,52,98,50,"response"],[85,60,98,58],[85,61,98,59,"status"],[85,67,98,65],[85,68,98,66],[86,10,99,8],[86,17,99,15],[87,12,99,17,"ok"],[87,14,99,19],[87,16,99,21],[88,10,99,27],[88,11,99,28],[89,8,100,6],[90,8,102,6],[90,14,102,12,"result"],[90,20,102,18],[90,23,102,21],[90,29,102,27,"response"],[90,37,102,35],[90,38,102,36,"json"],[90,42,102,40],[90,43,102,41],[90,44,102,42],[91,8,103,6,"console"],[91,15,103,13],[91,16,103,14,"log"],[91,19,103,17],[91,20,103,18],[91,43,103,41,"orderId"],[91,50,103,48],[91,70,103,68,"result"],[91,76,103,74],[91,77,103,75,"commission"],[91,87,103,85],[91,103,103,101,"result"],[91,109,103,107],[91,110,103,108,"creatorId"],[91,119,103,117],[91,121,103,119],[91,122,103,120],[92,8,104,6],[92,15,104,13,"result"],[92,21,104,19],[93,6,105,4],[93,7,105,5],[93,8,105,6],[93,15,105,13,"error"],[93,20,105,18],[93,22,105,20],[94,8,106,6,"console"],[94,15,106,13],[94,16,106,14,"error"],[94,21,106,19],[94,22,106,20],[94,48,106,46],[94,50,106,48,"error"],[94,55,106,53],[94,56,106,54],[95,8,107,6],[95,15,107,13],[96,10,107,15,"ok"],[96,12,107,17],[96,14,107,19],[97,8,107,25],[97,9,107,26],[98,6,108,4],[99,4,109,2],[99,5,109,3],[99,7,109,5],[99,8,109,6,"userId"],[99,14,109,12],[99,15,109,13],[99,16,109,14],[100,4,111,2],[100,11,111,9],[101,6,112,4,"trackImpression"],[101,21,112,19],[102,6,113,4,"trackCTA"],[102,14,113,12],[103,6,114,4,"trackPurchase"],[104,4,115,2],[104,5,115,3],[105,2,116,0],[106,0,116,1],[106,3]],"functionMap":{"names":["<global>","useCommerceEvents","getBaseUrl","trackImpression","trackCTA","trackPurchase"],"mappings":"AAA;OCoB;qBCC;GDE;sCEE;GFqB;+BGE;GHsB;oCIE;GJoC"},"hasCjsExports":false},"type":"js/module"}]}