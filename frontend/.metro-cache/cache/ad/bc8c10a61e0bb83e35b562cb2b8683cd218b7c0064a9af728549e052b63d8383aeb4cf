{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":81,"index":81}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":82},"end":{"line":2,"column":69,"index":151}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"../lib/PrefetchCoordinator","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":152},"end":{"line":3,"column":65,"index":217}}],"key":"fxESIL0Vs+yHuGJWuxQHmLeHfpE=","exportNames":["*"],"imports":1}},{"name":"../components/PerfHUD","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":218},"end":{"line":4,"column":48,"index":266}}],"key":"zwBDOWOPpuFt3YJT1fYEAuvHuT0=","exportNames":["*"],"imports":1}},{"name":"../components/StoryCard","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":267},"end":{"line":5,"column":52,"index":319}}],"key":"WmPg7P1aUfwoCfSMyKym8fUbZE4=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/app/stories/StoriesScreen.tsx\",\n    _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return StoriesScreen;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2], \"react\");\n  var _reactNative = require(_dependencyMap[3], \"react-native\");\n  var _libPrefetchCoordinator = require(_dependencyMap[4], \"../lib/PrefetchCoordinator\");\n  var _componentsPerfHUD = require(_dependencyMap[5], \"../components/PerfHUD\");\n  var _componentsStoryCard = require(_dependencyMap[6], \"../components/StoryCard\");\n  var _reactJsxDevRuntime = require(_dependencyMap[7], \"react/jsx-dev-runtime\");\n  var _Dimensions$get = _reactNative.Dimensions.get('window'),\n    width = _Dimensions$get.width;\n  function StoriesScreen(_ref) {\n    _s();\n    var stories = _ref.stories;\n    var _useState = (0, _react.useState)(0),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      visibleIndex = _useState2[0],\n      setVisibleIndex = _useState2[1];\n\n    // --- Prefetcher (3-item lookahead with video support)\n    var prefetchRef = (0, _react.useRef)(new _libPrefetchCoordinator.PrefetchCoordinator(stories, 3)).current;\n    (0, _react.useEffect)(() => {\n      prefetchRef.attachGlobal();\n      prefetchRef.updateStories(stories);\n    }, [stories]);\n\n    // --- Viewability â†’ inform prefetch focus & track visible videos\n    var viewabilityConfig = (0, _react.useMemo)(() => ({\n      itemVisiblePercentThreshold: 80\n    }), []);\n    var onViewableItemsChanged = (0, _react.useRef)(_ref2 => {\n      var viewableItems = _ref2.viewableItems;\n      var idx = viewableItems[0]?.index ?? 0;\n      setVisibleIndex(idx);\n      prefetchRef.focus(idx);\n      globalThis.__visibleIndex = idx;\n    }).current;\n    var renderItem = (0, _react.useCallback)(_ref3 => {\n      var item = _ref3.item,\n        index = _ref3.index;\n      return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_componentsStoryCard.StoryCard, {\n        story: {\n          ...item,\n          __visible: index === visibleIndex\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 5\n      }, this);\n    }, [visibleIndex]);\n    var getItemLayout = (0, _react.useCallback)((_, i) => ({\n      length: width,\n      offset: width * i,\n      index: i\n    }), []);\n    var onEndReached = (0, _react.useCallback)(() => {\n      // trigger pagination; backend already supports cursor\n      // fetchMore();\n    }, []);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNative.View, {\n      style: {\n        flex: 1,\n        backgroundColor: '#1A1A1A'\n      },\n      children: [/*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNative.FlatList, {\n        data: stories,\n        renderItem: renderItem,\n        keyExtractor: s => s.id,\n        horizontal: true,\n        pagingEnabled: true,\n        showsHorizontalScrollIndicator: false,\n        windowSize: 5,\n        initialNumToRender: 3,\n        maxToRenderPerBatch: 4,\n        updateCellsBatchingPeriod: 50,\n        removeClippedSubviews: true,\n        overScrollMode: \"never\",\n        viewabilityConfig: viewabilityConfig,\n        onViewableItemsChanged: onViewableItemsChanged,\n        getItemLayout: getItemLayout,\n        onEndReached: onEndReached,\n        onEndReachedThreshold: 0.7\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 7\n      }, this), _expoVirtualEnv.env.EXPO_PUBLIC_SHOW_PERF_HUD === \"1\" && /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_componentsPerfHUD.PerfHUD, {\n        creators: 1,\n        stories: stories.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }, this);\n  }\n  _s(StoriesScreen, \"0bJnxPG6Afj6YOaREQMnop86MIY=\");\n  _c = StoriesScreen;\n  var _c;\n  $RefreshReg$(_c, \"StoriesScreen\");\n});","lineCount":125,"map":[[14,2,11,15,"Object"],[14,8,11,15],[14,9,11,15,"defineProperty"],[14,23,11,15],[14,24,11,15,"exports"],[14,31,11,15],[15,4,11,15,"enumerable"],[15,14,11,15],[16,4,11,15,"get"],[16,7,11,15],[16,18,11,15,"get"],[16,19,11,15],[17,6,11,15],[17,13,11,15,"StoriesScreen"],[17,26,11,15],[18,4,11,15],[19,2,11,15],[20,2,72,1],[20,6,72,1,"_expoVirtualEnv"],[20,21,72,1],[20,24,72,1,"require"],[20,31,72,1],[20,32,72,1,"_dependencyMap"],[20,46,72,1],[21,2,72,1],[21,6,72,1,"_babelRuntimeHelpersSlicedToArray"],[21,39,72,1],[21,42,72,1,"require"],[21,49,72,1],[21,50,72,1,"_dependencyMap"],[21,64,72,1],[22,2,72,1],[22,6,72,1,"_slicedToArray"],[22,20,72,1],[22,23,72,1,"_interopDefault"],[22,38,72,1],[22,39,72,1,"_babelRuntimeHelpersSlicedToArray"],[22,72,72,1],[23,2,1,0],[23,6,1,0,"_react"],[23,12,1,0],[23,15,1,0,"require"],[23,22,1,0],[23,23,1,0,"_dependencyMap"],[23,37,1,0],[24,2,2,0],[24,6,2,0,"_reactNative"],[24,18,2,0],[24,21,2,0,"require"],[24,28,2,0],[24,29,2,0,"_dependencyMap"],[24,43,2,0],[25,2,3,0],[25,6,3,0,"_libPrefetchCoordinator"],[25,29,3,0],[25,32,3,0,"require"],[25,39,3,0],[25,40,3,0,"_dependencyMap"],[25,54,3,0],[26,2,4,0],[26,6,4,0,"_componentsPerfHUD"],[26,24,4,0],[26,27,4,0,"require"],[26,34,4,0],[26,35,4,0,"_dependencyMap"],[26,49,4,0],[27,2,5,0],[27,6,5,0,"_componentsStoryCard"],[27,26,5,0],[27,29,5,0,"require"],[27,36,5,0],[27,37,5,0,"_dependencyMap"],[27,51,5,0],[28,2,5,52],[28,6,5,52,"_reactJsxDevRuntime"],[28,25,5,52],[28,28,5,52,"require"],[28,35,5,52],[28,36,5,52,"_dependencyMap"],[28,50,5,52],[29,2,7,0],[29,6,7,0,"_Dimensions$get"],[29,21,7,0],[29,24,7,18,"Dimensions"],[29,36,7,28],[29,37,7,28,"Dimensions"],[29,47,7,28],[29,48,7,29,"get"],[29,51,7,32],[29,52,7,33],[29,60,7,41],[29,61,7,42],[30,4,7,8,"width"],[30,9,7,13],[30,12,7,13,"_Dimensions$get"],[30,27,7,13],[30,28,7,8,"width"],[30,33,7,13],[31,2,11,15],[31,11,11,24,"StoriesScreen"],[31,24,11,37,"StoriesScreen"],[31,25,11,37,"_ref"],[31,29,11,37],[31,31,11,73],[32,4,11,73,"_s"],[32,6,11,73],[33,4,11,73],[33,8,11,40,"stories"],[33,15,11,47],[33,18,11,47,"_ref"],[33,22,11,47],[33,23,11,40,"stories"],[33,30,11,47],[34,4,12,2],[34,8,12,2,"_useState"],[34,17,12,2],[34,20,12,42],[34,24,12,42,"useState"],[34,30,12,50],[34,31,12,50,"useState"],[34,39,12,50],[34,41,12,51],[34,42,12,52],[34,43,12,53],[35,6,12,53,"_useState2"],[35,16,12,53],[35,23,12,53,"_slicedToArray"],[35,37,12,53],[35,38,12,53,"default"],[35,45,12,53],[35,47,12,53,"_useState"],[35,56,12,53],[36,6,12,9,"visibleIndex"],[36,18,12,21],[36,21,12,21,"_useState2"],[36,31,12,21],[37,6,12,23,"setVisibleIndex"],[37,21,12,38],[37,24,12,38,"_useState2"],[37,34,12,38],[39,4,14,2],[40,4,15,2],[40,8,15,8,"prefetchRef"],[40,19,15,19],[40,22,15,22],[40,26,15,22,"useRef"],[40,32,15,28],[40,33,15,28,"useRef"],[40,39,15,28],[40,41,15,29],[40,45,15,33,"PrefetchCoordinator"],[40,68,15,52],[40,69,15,52,"PrefetchCoordinator"],[40,88,15,52],[40,89,15,53,"stories"],[40,96,15,60],[40,98,15,62],[40,99,15,63],[40,100,15,64],[40,101,15,65],[40,102,15,66,"current"],[40,109,15,73],[41,4,16,2],[41,8,16,2,"useEffect"],[41,14,16,11],[41,15,16,11,"useEffect"],[41,24,16,11],[41,26,16,12],[41,32,16,18],[42,6,17,4,"prefetchRef"],[42,17,17,15],[42,18,17,16,"attachGlobal"],[42,30,17,28],[42,31,17,29],[42,32,17,30],[43,6,18,4,"prefetchRef"],[43,17,18,15],[43,18,18,16,"updateStories"],[43,31,18,29],[43,32,18,30,"stories"],[43,39,18,37],[43,40,18,38],[44,4,19,2],[44,5,19,3],[44,7,19,5],[44,8,19,6,"stories"],[44,15,19,13],[44,16,19,14],[44,17,19,15],[46,4,21,2],[47,4,22,2],[47,8,22,8,"viewabilityConfig"],[47,25,22,25],[47,28,22,28],[47,32,22,28,"useMemo"],[47,38,22,35],[47,39,22,35,"useMemo"],[47,46,22,35],[47,48,22,36],[47,55,22,43],[48,6,22,45,"itemVisiblePercentThreshold"],[48,33,22,72],[48,35,22,74],[49,4,22,77],[49,5,22,78],[49,6,22,79],[49,8,22,81],[49,10,22,83],[49,11,22,84],[50,4,23,2],[50,8,23,8,"onViewableItemsChanged"],[50,30,23,30],[50,33,23,33],[50,37,23,33,"useRef"],[50,43,23,39],[50,44,23,39,"useRef"],[50,50,23,39],[50,52,24,4,"_ref2"],[50,57,24,4],[50,61,24,59],[51,6,24,59],[51,10,24,7,"viewableItems"],[51,23,24,20],[51,26,24,20,"_ref2"],[51,31,24,20],[51,32,24,7,"viewableItems"],[51,45,24,20],[52,6,25,6],[52,10,25,12,"idx"],[52,13,25,15],[52,16,25,18,"viewableItems"],[52,29,25,31],[52,30,25,32],[52,31,25,33],[52,32,25,34],[52,34,25,36,"index"],[52,39,25,41],[52,43,25,45],[52,44,25,46],[53,6,26,6,"setVisibleIndex"],[53,21,26,21],[53,22,26,22,"idx"],[53,25,26,25],[53,26,26,26],[54,6,27,6,"prefetchRef"],[54,17,27,17],[54,18,27,18,"focus"],[54,23,27,23],[54,24,27,24,"idx"],[54,27,27,27],[54,28,27,28],[55,6,28,7,"globalThis"],[55,16,28,17],[55,17,28,26,"__visibleIndex"],[55,31,28,40],[55,34,28,43,"idx"],[55,37,28,46],[56,4,29,4],[56,5,30,2],[56,6,30,3],[56,7,30,4,"current"],[56,14,30,11],[57,4,32,2],[57,8,32,8,"renderItem"],[57,18,32,18],[57,21,32,21],[57,25,32,21,"useCallback"],[57,31,32,32],[57,32,32,32,"useCallback"],[57,43,32,32],[57,45,32,33,"_ref3"],[57,50,32,33],[58,6,32,33],[58,10,32,36,"item"],[58,14,32,40],[58,17,32,40,"_ref3"],[58,22,32,40],[58,23,32,36,"item"],[58,27,32,40],[59,8,32,42,"index"],[59,13,32,47],[59,16,32,47,"_ref3"],[59,21,32,47],[59,22,32,42,"index"],[59,27,32,47],[60,6,32,47],[60,26,33,4],[60,30,33,4,"_reactJsxDevRuntime"],[60,49,33,4],[60,50,33,4,"jsxDEV"],[60,56,33,4],[60,58,33,5,"_componentsStoryCard"],[60,78,33,14],[60,79,33,14,"StoryCard"],[60,88,33,14],[61,8,33,15,"story"],[61,13,33,20],[61,15,33,22],[62,10,33,24],[62,13,33,27,"item"],[62,17,33,31],[63,10,33,33,"__visible"],[63,19,33,42],[63,21,33,44,"index"],[63,26,33,49],[63,31,33,54,"visibleIndex"],[64,8,33,67],[65,6,33,69],[66,8,33,69,"fileName"],[66,16,33,69],[66,18,33,69,"_jsxFileName"],[66,30,33,69],[67,8,33,69,"lineNumber"],[67,18,33,69],[68,8,33,69,"columnNumber"],[68,20,33,69],[69,6,33,69],[69,13,33,71],[69,14,33,72],[70,4,33,72],[70,5,34,3],[70,7,34,5],[70,8,34,6,"visibleIndex"],[70,20,34,18],[70,21,34,19],[70,22,34,20],[71,4,36,2],[71,8,36,8,"getItemLayout"],[71,21,36,21],[71,24,36,24],[71,28,36,24,"useCallback"],[71,34,36,35],[71,35,36,35,"useCallback"],[71,46,36,35],[71,48,36,36],[71,49,36,37,"_"],[71,50,36,43],[71,52,36,45,"i"],[71,53,36,54],[71,59,37,4],[72,6,37,6,"length"],[72,12,37,12],[72,14,37,14,"width"],[72,19,37,19],[73,6,37,21,"offset"],[73,12,37,27],[73,14,37,29,"width"],[73,19,37,34],[73,22,37,37,"i"],[73,23,37,38],[74,6,37,40,"index"],[74,11,37,45],[74,13,37,47,"i"],[75,4,37,49],[75,5,37,50],[75,6,38,3],[75,8,38,5],[75,10,38,7],[75,11,38,8],[76,4,40,2],[76,8,40,8,"onEndReached"],[76,20,40,20],[76,23,40,23],[76,27,40,23,"useCallback"],[76,33,40,34],[76,34,40,34,"useCallback"],[76,45,40,34],[76,47,40,35],[76,53,40,41],[77,6,41,4],[78,6,42,4],[79,4,42,4],[79,5,43,3],[79,7,43,5],[79,9,43,7],[79,10,43,8],[80,4,45,2],[80,24,46,4],[80,28,46,4,"_reactJsxDevRuntime"],[80,47,46,4],[80,48,46,4,"jsxDEV"],[80,54,46,4],[80,56,46,5,"_reactNative"],[80,68,46,9],[80,69,46,9,"View"],[80,73,46,9],[81,6,46,10,"style"],[81,11,46,15],[81,13,46,17],[82,8,46,19,"flex"],[82,12,46,23],[82,14,46,25],[82,15,46,26],[83,8,46,28,"backgroundColor"],[83,23,46,43],[83,25,46,45],[84,6,46,55],[84,7,46,57],[85,6,46,57,"children"],[85,14,46,57],[85,30,47,6],[85,34,47,6,"_reactJsxDevRuntime"],[85,53,47,6],[85,54,47,6,"jsxDEV"],[85,60,47,6],[85,62,47,7,"_reactNative"],[85,74,47,15],[85,75,47,15,"FlatList"],[85,83,47,15],[86,8,48,8,"data"],[86,12,48,12],[86,14,48,14,"stories"],[86,21,48,22],[87,8,49,8,"renderItem"],[87,18,49,18],[87,20,49,20,"renderItem"],[87,30,49,31],[88,8,50,8,"keyExtractor"],[88,20,50,20],[88,22,50,23,"s"],[88,23,50,24],[88,27,50,29,"s"],[88,28,50,30],[88,29,50,31,"id"],[88,31,50,34],[89,8,51,8,"horizontal"],[89,18,51,18],[90,8,52,8,"pagingEnabled"],[90,21,52,21],[91,8,53,8,"showsHorizontalScrollIndicator"],[91,38,53,38],[91,40,53,40],[91,45,53,46],[92,8,54,8,"windowSize"],[92,18,54,18],[92,20,54,20],[92,21,54,22],[93,8,55,8,"initialNumToRender"],[93,26,55,26],[93,28,55,28],[93,29,55,30],[94,8,56,8,"maxToRenderPerBatch"],[94,27,56,27],[94,29,56,29],[94,30,56,31],[95,8,57,8,"updateCellsBatchingPeriod"],[95,33,57,33],[95,35,57,35],[95,37,57,38],[96,8,58,8,"removeClippedSubviews"],[96,29,58,29],[97,8,59,8,"overScrollMode"],[97,22,59,22],[97,24,59,23],[97,31,59,30],[98,8,60,8,"viewabilityConfig"],[98,25,60,25],[98,27,60,27,"viewabilityConfig"],[98,44,60,45],[99,8,61,8,"onViewableItemsChanged"],[99,30,61,30],[99,32,61,32,"onViewableItemsChanged"],[99,54,61,55],[100,8,62,8,"getItemLayout"],[100,21,62,21],[100,23,62,23,"getItemLayout"],[100,36,62,37],[101,8,63,8,"onEndReached"],[101,20,63,20],[101,22,63,22,"onEndReached"],[101,34,63,35],[102,8,64,8,"onEndReachedThreshold"],[102,29,64,29],[102,31,64,31],[103,6,64,35],[104,8,64,35,"fileName"],[104,16,64,35],[104,18,64,35,"_jsxFileName"],[104,30,64,35],[105,8,64,35,"lineNumber"],[105,18,64,35],[106,8,64,35,"columnNumber"],[106,20,64,35],[107,6,64,35],[107,13,65,7],[107,14,65,8],[107,16,67,7,"_expoVirtualEnv"],[107,31,67,7],[107,32,67,7,"env"],[107,35,67,7],[107,36,67,7,"EXPO_PUBLIC_SHOW_PERF_HUD"],[107,61,67,7],[107,66,67,49],[107,69,67,52],[107,86,68,8],[107,90,68,8,"_reactJsxDevRuntime"],[107,109,68,8],[107,110,68,8,"jsxDEV"],[107,116,68,8],[107,118,68,9,"_componentsPerfHUD"],[107,136,68,16],[107,137,68,16,"PerfHUD"],[107,144,68,16],[108,8,68,17,"creators"],[108,16,68,25],[108,18,68,27],[108,19,68,29],[109,8,68,30,"stories"],[109,15,68,37],[109,17,68,39,"stories"],[109,24,68,46],[109,25,68,47,"length"],[110,6,68,54],[111,8,68,54,"fileName"],[111,16,68,54],[111,18,68,54,"_jsxFileName"],[111,30,68,54],[112,8,68,54,"lineNumber"],[112,18,68,54],[113,8,68,54,"columnNumber"],[113,20,68,54],[114,6,68,54],[114,13,68,56],[114,14,69,7],[115,4,69,7],[116,6,69,7,"fileName"],[116,14,69,7],[116,16,69,7,"_jsxFileName"],[116,28,69,7],[117,6,69,7,"lineNumber"],[117,16,69,7],[118,6,69,7,"columnNumber"],[118,18,69,7],[119,4,69,7],[119,11,70,10],[119,12,70,11],[120,2,72,0],[121,2,72,1,"_s"],[121,4,72,1],[121,5,11,24,"StoriesScreen"],[121,18,11,37],[122,2,11,37,"_c"],[122,4,11,37],[122,7,11,24,"StoriesScreen"],[122,20,11,37],[123,2,11,37],[123,6,11,37,"_c"],[123,8,11,37],[124,2,11,37,"$RefreshReg$"],[124,14,11,37],[124,15,11,37,"_c"],[124,17,11,37],[125,0,11,37],[125,3]],"functionMap":{"names":["<global>","StoriesScreen","useEffect$argument_0","useMemo$argument_0","useRef$argument_0","renderItem","getItemLayout","onEndReached","FlatList.props.keyExtractor"],"mappings":"AAA;eCU;YCK;GDG;oCEG,2CF;IGE;KHK;iCIG;GJE;oCKE;GLE;mCME;GNG;sBOO,WP"},"hasCjsExports":false},"type":"js/module"}]}