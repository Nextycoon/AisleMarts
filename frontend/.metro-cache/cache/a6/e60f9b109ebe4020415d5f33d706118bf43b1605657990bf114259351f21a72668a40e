{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":117},"end":{"line":5,"column":36,"index":153}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":154},"end":{"line":6,"column":39,"index":193}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  /**\n   * Phase 3 Commerce Tracking Hook\n   * Tracks story impressions, CTAs, and purchases for affiliate attribution\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useCommerceEvents = useCommerceEvents;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _expoVirtualEnv = require(_dependencyMap[1], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[2], \"react\");\n  var _expoConstants = require(_dependencyMap[3], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  function useCommerceEvents(userId) {\n    _s();\n    var getBaseUrl = () => {\n      return Constants.default.expoConfig?.extra?.backendUrl || _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n    };\n    var trackImpression = (0, _react.useCallback)(/*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator.default)(function* (storyId, userIdOverride) {\n        try {\n          var response = yield fetch(`${getBaseUrl()}/api/track/impression`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              storyId,\n              userId: userIdOverride || userId\n            })\n          });\n          if (!response.ok) {\n            console.warn('Failed to track impression:', response.status);\n          } else {\n            console.log(`✅ Impression tracked: ${storyId}`);\n          }\n        } catch (error) {\n          console.error('Error tracking impression:', error);\n        }\n      });\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }(), [userId]);\n    var trackCTA = (0, _react.useCallback)(/*#__PURE__*/function () {\n      var _ref2 = (0, _asyncToGenerator.default)(function* (storyId, productId, userIdOverride) {\n        try {\n          var response = yield fetch(`${getBaseUrl()}/api/track/cta`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              storyId,\n              productId,\n              userId: userIdOverride || userId\n            })\n          });\n          if (!response.ok) {\n            console.warn('Failed to track CTA:', response.status);\n          } else {\n            console.log(`✅ CTA tracked: ${storyId} -> ${productId}`);\n          }\n        } catch (error) {\n          console.error('Error tracking CTA:', error);\n        }\n      });\n      return function (_x3, _x4, _x5) {\n        return _ref2.apply(this, arguments);\n      };\n    }(), [userId]);\n    var trackPurchase = (0, _react.useCallback)(/*#__PURE__*/function () {\n      var _ref3 = (0, _asyncToGenerator.default)(function* (orderId, productId, amount, currency, referrerStoryId, userIdOverride) {\n        try {\n          var response = yield fetch(`${getBaseUrl()}/api/track/purchase`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              orderId,\n              userId: userIdOverride || userId,\n              productId,\n              amount,\n              currency,\n              referrerStoryId\n            })\n          });\n          if (!response.ok) {\n            console.warn('Failed to track purchase:', response.status);\n            return {\n              ok: false\n            };\n          }\n          var result = yield response.json();\n          console.log(`✅ Purchase tracked: ${orderId} -> Commission: $${result.commission} to creator: ${result.creatorId}`);\n          return result;\n        } catch (error) {\n          console.error('Error tracking purchase:', error);\n          return {\n            ok: false\n          };\n        }\n      });\n      return function (_x6, _x7, _x8, _x9, _x0, _x1) {\n        return _ref3.apply(this, arguments);\n      };\n    }(), [userId]);\n    return {\n      trackImpression,\n      trackCTA,\n      trackPurchase\n    };\n  }\n  _s(useCommerceEvents, \"gRxmmxeOmNuuxlDo1MaLrqqY+G8=\");\n});","lineCount":126,"map":[[5,2,1,0],[6,0,2,0],[7,0,3,0],[8,0,4,0],[9,2,1,0,"Object"],[9,8,1,0],[9,9,1,0,"defineProperty"],[9,23,1,0],[9,24,1,0,"exports"],[9,31,1,0],[10,4,1,0,"value"],[10,9,1,0],[11,2,1,0],[12,2,1,0],[12,11,1,0,"_interopDefault"],[12,27,1,0,"e"],[12,28,1,0],[13,4,1,0],[13,11,1,0,"e"],[13,12,1,0],[13,16,1,0,"e"],[13,17,1,0],[13,18,1,0,"__esModule"],[13,28,1,0],[13,31,1,0,"e"],[13,32,1,0],[14,6,1,0,"default"],[14,13,1,0],[14,15,1,0,"e"],[15,4,1,0],[16,2,1,0],[17,2,21,0,"exports"],[17,9,21,0],[17,10,21,0,"useCommerceEvents"],[17,27,21,0],[17,30,21,0,"useCommerceEvents"],[17,47,21,0],[18,2,116,1],[18,6,116,1,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,116,1],[18,45,116,1,"require"],[18,52,116,1],[18,53,116,1,"_dependencyMap"],[18,67,116,1],[19,2,116,1],[19,6,116,1,"_asyncToGenerator"],[19,23,116,1],[19,26,116,1,"_interopDefault"],[19,41,116,1],[19,42,116,1,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,116,1],[20,2,116,1],[20,6,116,1,"_expoVirtualEnv"],[20,21,116,1],[20,24,116,1,"require"],[20,31,116,1],[20,32,116,1,"_dependencyMap"],[20,46,116,1],[21,2,5,0],[21,6,5,0,"_react"],[21,12,5,0],[21,15,5,0,"require"],[21,22,5,0],[21,23,5,0,"_dependencyMap"],[21,37,5,0],[22,2,6,0],[22,6,6,0,"_expoConstants"],[22,20,6,0],[22,23,6,0,"require"],[22,30,6,0],[22,31,6,0,"_dependencyMap"],[22,45,6,0],[23,2,6,0],[23,6,6,0,"Constants"],[23,15,6,0],[23,18,6,0,"_interopDefault"],[23,33,6,0],[23,34,6,0,"_expoConstants"],[23,48,6,0],[24,2,21,7],[24,11,21,16,"useCommerceEvents"],[24,28,21,33,"useCommerceEvents"],[24,29,21,34,"userId"],[24,35,21,49],[24,37,21,70],[25,4,21,70,"_s"],[25,6,21,70],[26,4,22,2],[26,8,22,8,"getBaseUrl"],[26,18,22,18],[26,21,22,21,"getBaseUrl"],[26,22,22,21],[26,27,22,27],[27,6,23,4],[27,13,23,11,"Constants"],[27,22,23,20],[27,23,23,20,"default"],[27,30,23,20],[27,31,23,21,"expoConfig"],[27,41,23,31],[27,43,23,33,"extra"],[27,48,23,38],[27,50,23,40,"backendUrl"],[27,60,23,50],[27,64,23,50,"_expoVirtualEnv"],[27,79,23,50],[27,80,23,50,"env"],[27,83,23,50],[27,84,23,50,"EXPO_PUBLIC_BACKEND_URL"],[27,107,23,89],[27,111,23,93],[27,134,23,116],[28,4,24,2],[28,5,24,3],[29,4,26,2],[29,8,26,8,"trackImpression"],[29,23,26,23],[29,26,26,26],[29,30,26,26,"useCallback"],[29,36,26,37],[29,37,26,37,"useCallback"],[29,48,26,37],[30,6,26,37],[30,10,26,37,"_ref"],[30,14,26,37],[30,21,26,37,"_asyncToGenerator"],[30,38,26,37],[30,39,26,37,"default"],[30,46,26,37],[30,48,26,38],[30,59,26,45,"storyId"],[30,66,26,60],[30,68,26,62,"userIdOverride"],[30,82,26,85],[30,84,26,90],[31,8,27,4],[31,12,27,8],[32,10,28,6],[32,14,28,12,"response"],[32,22,28,20],[32,31,28,29,"fetch"],[32,36,28,34],[32,37,28,35],[32,40,28,38,"getBaseUrl"],[32,50,28,48],[32,51,28,49],[32,52,28,50],[32,75,28,73],[32,77,28,75],[33,12,29,8,"method"],[33,18,29,14],[33,20,29,16],[33,26,29,22],[34,12,30,8,"headers"],[34,19,30,15],[34,21,30,17],[35,14,31,10],[35,28,31,24],[35,30,31,26],[36,12,32,8],[36,13,32,9],[37,12,33,8,"body"],[37,16,33,12],[37,18,33,14,"JSON"],[37,22,33,18],[37,23,33,19,"stringify"],[37,32,33,28],[37,33,33,29],[38,14,34,10,"storyId"],[38,21,34,17],[39,14,35,10,"userId"],[39,20,35,16],[39,22,35,18,"userIdOverride"],[39,36,35,32],[39,40,35,36,"userId"],[40,12,36,8],[40,13,36,9],[41,10,37,6],[41,11,37,7],[41,12,37,8],[42,10,39,6],[42,14,39,10],[42,15,39,11,"response"],[42,23,39,19],[42,24,39,20,"ok"],[42,26,39,22],[42,28,39,24],[43,12,40,8,"console"],[43,19,40,15],[43,20,40,16,"warn"],[43,24,40,20],[43,25,40,21],[43,54,40,50],[43,56,40,52,"response"],[43,64,40,60],[43,65,40,61,"status"],[43,71,40,67],[43,72,40,68],[44,10,41,6],[44,11,41,7],[44,17,41,13],[45,12,42,8,"console"],[45,19,42,15],[45,20,42,16,"log"],[45,23,42,19],[45,24,42,20],[45,49,42,45,"storyId"],[45,56,42,52],[45,58,42,54],[45,59,42,55],[46,10,43,6],[47,8,44,4],[47,9,44,5],[47,10,44,6],[47,17,44,13,"error"],[47,22,44,18],[47,24,44,20],[48,10,45,6,"console"],[48,17,45,13],[48,18,45,14,"error"],[48,23,45,19],[48,24,45,20],[48,52,45,48],[48,54,45,50,"error"],[48,59,45,55],[48,60,45,56],[49,8,46,4],[50,6,47,2],[50,7,47,3],[51,6,47,3],[51,23,47,3,"_x"],[51,25,47,3],[51,27,47,3,"_x2"],[51,30,47,3],[52,8,47,3],[52,15,47,3,"_ref"],[52,19,47,3],[52,20,47,3,"apply"],[52,25,47,3],[52,32,47,3,"arguments"],[52,41,47,3],[53,6,47,3],[54,4,47,3],[54,9,47,5],[54,10,47,6,"userId"],[54,16,47,12],[54,17,47,13],[54,18,47,14],[55,4,49,2],[55,8,49,8,"trackCTA"],[55,16,49,16],[55,19,49,19],[55,23,49,19,"useCallback"],[55,29,49,30],[55,30,49,30,"useCallback"],[55,41,49,30],[56,6,49,30],[56,10,49,30,"_ref2"],[56,15,49,30],[56,22,49,30,"_asyncToGenerator"],[56,39,49,30],[56,40,49,30,"default"],[56,47,49,30],[56,49,49,31],[56,60,49,38,"storyId"],[56,67,49,53],[56,69,49,55,"productId"],[56,78,49,73],[56,80,49,75,"userIdOverride"],[56,94,49,98],[56,96,49,103],[57,8,50,4],[57,12,50,8],[58,10,51,6],[58,14,51,12,"response"],[58,22,51,20],[58,31,51,29,"fetch"],[58,36,51,34],[58,37,51,35],[58,40,51,38,"getBaseUrl"],[58,50,51,48],[58,51,51,49],[58,52,51,50],[58,68,51,66],[58,70,51,68],[59,12,52,8,"method"],[59,18,52,14],[59,20,52,16],[59,26,52,22],[60,12,53,8,"headers"],[60,19,53,15],[60,21,53,17],[61,14,54,10],[61,28,54,24],[61,30,54,26],[62,12,55,8],[62,13,55,9],[63,12,56,8,"body"],[63,16,56,12],[63,18,56,14,"JSON"],[63,22,56,18],[63,23,56,19,"stringify"],[63,32,56,28],[63,33,56,29],[64,14,57,10,"storyId"],[64,21,57,17],[65,14,58,10,"productId"],[65,23,58,19],[66,14,59,10,"userId"],[66,20,59,16],[66,22,59,18,"userIdOverride"],[66,36,59,32],[66,40,59,36,"userId"],[67,12,60,8],[67,13,60,9],[68,10,61,6],[68,11,61,7],[68,12,61,8],[69,10,63,6],[69,14,63,10],[69,15,63,11,"response"],[69,23,63,19],[69,24,63,20,"ok"],[69,26,63,22],[69,28,63,24],[70,12,64,8,"console"],[70,19,64,15],[70,20,64,16,"warn"],[70,24,64,20],[70,25,64,21],[70,47,64,43],[70,49,64,45,"response"],[70,57,64,53],[70,58,64,54,"status"],[70,64,64,60],[70,65,64,61],[71,10,65,6],[71,11,65,7],[71,17,65,13],[72,12,66,8,"console"],[72,19,66,15],[72,20,66,16,"log"],[72,23,66,19],[72,24,66,20],[72,42,66,38,"storyId"],[72,49,66,45],[72,56,66,52,"productId"],[72,65,66,61],[72,67,66,63],[72,68,66,64],[73,10,67,6],[74,8,68,4],[74,9,68,5],[74,10,68,6],[74,17,68,13,"error"],[74,22,68,18],[74,24,68,20],[75,10,69,6,"console"],[75,17,69,13],[75,18,69,14,"error"],[75,23,69,19],[75,24,69,20],[75,45,69,41],[75,47,69,43,"error"],[75,52,69,48],[75,53,69,49],[76,8,70,4],[77,6,71,2],[77,7,71,3],[78,6,71,3],[78,23,71,3,"_x3"],[78,26,71,3],[78,28,71,3,"_x4"],[78,31,71,3],[78,33,71,3,"_x5"],[78,36,71,3],[79,8,71,3],[79,15,71,3,"_ref2"],[79,20,71,3],[79,21,71,3,"apply"],[79,26,71,3],[79,33,71,3,"arguments"],[79,42,71,3],[80,6,71,3],[81,4,71,3],[81,9,71,5],[81,10,71,6,"userId"],[81,16,71,12],[81,17,71,13],[81,18,71,14],[82,4,73,2],[82,8,73,8,"trackPurchase"],[82,21,73,21],[82,24,73,24],[82,28,73,24,"useCallback"],[82,34,73,35],[82,35,73,35,"useCallback"],[82,46,73,35],[83,6,73,35],[83,10,73,35,"_ref3"],[83,15,73,35],[83,22,73,35,"_asyncToGenerator"],[83,39,73,35],[83,40,73,35,"default"],[83,47,73,35],[83,49,73,36],[83,60,74,4,"orderId"],[83,67,74,19],[83,69,75,4,"productId"],[83,78,75,21],[83,80,76,4,"amount"],[83,86,76,18],[83,88,77,4,"currency"],[83,96,77,20],[83,98,78,4,"referrerStoryId"],[83,113,78,28],[83,115,79,4,"userIdOverride"],[83,129,79,27],[83,131,80,7],[84,8,81,4],[84,12,81,8],[85,10,82,6],[85,14,82,12,"response"],[85,22,82,20],[85,31,82,29,"fetch"],[85,36,82,34],[85,37,82,35],[85,40,82,38,"getBaseUrl"],[85,50,82,48],[85,51,82,49],[85,52,82,50],[85,73,82,71],[85,75,82,73],[86,12,83,8,"method"],[86,18,83,14],[86,20,83,16],[86,26,83,22],[87,12,84,8,"headers"],[87,19,84,15],[87,21,84,17],[88,14,85,10],[88,28,85,24],[88,30,85,26],[89,12,86,8],[89,13,86,9],[90,12,87,8,"body"],[90,16,87,12],[90,18,87,14,"JSON"],[90,22,87,18],[90,23,87,19,"stringify"],[90,32,87,28],[90,33,87,29],[91,14,88,10,"orderId"],[91,21,88,17],[92,14,89,10,"userId"],[92,20,89,16],[92,22,89,18,"userIdOverride"],[92,36,89,32],[92,40,89,36,"userId"],[92,46,89,42],[93,14,90,10,"productId"],[93,23,90,19],[94,14,91,10,"amount"],[94,20,91,16],[95,14,92,10,"currency"],[95,22,92,18],[96,14,93,10,"referrerStoryId"],[97,12,94,8],[97,13,94,9],[98,10,95,6],[98,11,95,7],[98,12,95,8],[99,10,97,6],[99,14,97,10],[99,15,97,11,"response"],[99,23,97,19],[99,24,97,20,"ok"],[99,26,97,22],[99,28,97,24],[100,12,98,8,"console"],[100,19,98,15],[100,20,98,16,"warn"],[100,24,98,20],[100,25,98,21],[100,52,98,48],[100,54,98,50,"response"],[100,62,98,58],[100,63,98,59,"status"],[100,69,98,65],[100,70,98,66],[101,12,99,8],[101,19,99,15],[102,14,99,17,"ok"],[102,16,99,19],[102,18,99,21],[103,12,99,27],[103,13,99,28],[104,10,100,6],[105,10,102,6],[105,14,102,12,"result"],[105,20,102,18],[105,29,102,27,"response"],[105,37,102,35],[105,38,102,36,"json"],[105,42,102,40],[105,43,102,41],[105,44,102,42],[106,10,103,6,"console"],[106,17,103,13],[106,18,103,14,"log"],[106,21,103,17],[106,22,103,18],[106,45,103,41,"orderId"],[106,52,103,48],[106,72,103,68,"result"],[106,78,103,74],[106,79,103,75,"commission"],[106,89,103,85],[106,105,103,101,"result"],[106,111,103,107],[106,112,103,108,"creatorId"],[106,121,103,117],[106,123,103,119],[106,124,103,120],[107,10,104,6],[107,17,104,13,"result"],[107,23,104,19],[108,8,105,4],[108,9,105,5],[108,10,105,6],[108,17,105,13,"error"],[108,22,105,18],[108,24,105,20],[109,10,106,6,"console"],[109,17,106,13],[109,18,106,14,"error"],[109,23,106,19],[109,24,106,20],[109,50,106,46],[109,52,106,48,"error"],[109,57,106,53],[109,58,106,54],[110,10,107,6],[110,17,107,13],[111,12,107,15,"ok"],[111,14,107,17],[111,16,107,19],[112,10,107,25],[112,11,107,26],[113,8,108,4],[114,6,109,2],[114,7,109,3],[115,6,109,3],[115,23,109,3,"_x6"],[115,26,109,3],[115,28,109,3,"_x7"],[115,31,109,3],[115,33,109,3,"_x8"],[115,36,109,3],[115,38,109,3,"_x9"],[115,41,109,3],[115,43,109,3,"_x0"],[115,46,109,3],[115,48,109,3,"_x1"],[115,51,109,3],[116,8,109,3],[116,15,109,3,"_ref3"],[116,20,109,3],[116,21,109,3,"apply"],[116,26,109,3],[116,33,109,3,"arguments"],[116,42,109,3],[117,6,109,3],[118,4,109,3],[118,9,109,5],[118,10,109,6,"userId"],[118,16,109,12],[118,17,109,13],[118,18,109,14],[119,4,111,2],[119,11,111,9],[120,6,112,4,"trackImpression"],[120,21,112,19],[121,6,113,4,"trackCTA"],[121,14,113,12],[122,6,114,4,"trackPurchase"],[123,4,115,2],[123,5,115,3],[124,2,116,0],[125,2,116,1,"_s"],[125,4,116,1],[125,5,21,16,"useCommerceEvents"],[125,22,21,33],[126,0,21,33],[126,3]],"functionMap":{"names":["<global>","useCommerceEvents","getBaseUrl","trackImpression","trackCTA","trackPurchase"],"mappings":"AAA;OCoB;qBCC;GDE;sCEE;GFqB;+BGE;GHsB;oCIE;GJoC"},"hasCjsExports":false},"type":"js/module"}]}