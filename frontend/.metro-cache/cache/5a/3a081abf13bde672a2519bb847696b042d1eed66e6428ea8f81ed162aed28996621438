{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":65,"index":65}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":37,"index":103}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useStoriesCursor = useStoriesCursor;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _api = require(_dependencyMap[1], \"./api\");\n  function useStoriesCursor(initialCursor = null, pageSize = 24) {\n    const [stories, setStories] = (0, _react.useState)([]);\n    const [cursor, setCursor] = (0, _react.useState)(initialCursor);\n    const [loading, setLoading] = (0, _react.useState)(false);\n    const [done, setDone] = (0, _react.useState)(false);\n    const inflight = (0, _react.useRef)(null);\n    const loadMore = (0, _react.useCallback)(async () => {\n      if (loading || done) return;\n      setLoading(true);\n      try {\n        const p = (0, _api.fetchStories)(cursor, pageSize);\n        inflight.current = p;\n        const res = await p;\n        setStories(prev => [...prev, ...res.data]);\n        setCursor(res.cursor ?? null);\n        if (!res.cursor || res.data.length === 0) setDone(true);\n      } finally {\n        inflight.current = null;\n        setLoading(false);\n      }\n    }, [cursor, done, loading, pageSize]);\n    (0, _react.useEffect)(() => {\n      if (stories.length === 0) loadMore();\n    }, []); // initial\n\n    return {\n      stories,\n      loadMore,\n      loading,\n      done\n    };\n  }\n});","lineCount":42,"map":[[7,2,5,0,"exports"],[7,9,5,0],[7,10,5,0,"useStoriesCursor"],[7,26,5,0],[7,29,5,0,"useStoriesCursor"],[7,45,5,0],[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"require"],[8,22,1,0],[8,23,1,0,"_dependencyMap"],[8,37,1,0],[9,2,2,0],[9,6,2,0,"_api"],[9,10,2,0],[9,13,2,0,"require"],[9,20,2,0],[9,21,2,0,"_dependencyMap"],[9,35,2,0],[10,2,5,7],[10,11,5,16,"useStoriesCursor"],[10,27,5,32,"useStoriesCursor"],[10,28,5,33,"initialCursor"],[10,41,5,61],[10,44,5,64],[10,48,5,68],[10,50,5,70,"pageSize"],[10,58,5,78],[10,61,5,81],[10,63,5,83],[10,65,5,85],[11,4,6,2],[11,10,6,8],[11,11,6,9,"stories"],[11,18,6,16],[11,20,6,18,"setStories"],[11,30,6,28],[11,31,6,29],[11,34,6,32],[11,38,6,32,"useState"],[11,44,6,40],[11,45,6,40,"useState"],[11,53,6,40],[11,55,6,50],[11,57,6,52],[11,58,6,53],[12,4,7,2],[12,10,7,8],[12,11,7,9,"cursor"],[12,17,7,15],[12,19,7,17,"setCursor"],[12,28,7,26],[12,29,7,27],[12,32,7,30],[12,36,7,30,"useState"],[12,42,7,38],[12,43,7,38,"useState"],[12,51,7,38],[12,53,7,54,"initialCursor"],[12,66,7,67],[12,67,7,68],[13,4,8,2],[13,10,8,8],[13,11,8,9,"loading"],[13,18,8,16],[13,20,8,18,"setLoading"],[13,30,8,28],[13,31,8,29],[13,34,8,32],[13,38,8,32,"useState"],[13,44,8,40],[13,45,8,40,"useState"],[13,53,8,40],[13,55,8,41],[13,60,8,46],[13,61,8,47],[14,4,9,2],[14,10,9,8],[14,11,9,9,"done"],[14,15,9,13],[14,17,9,15,"setDone"],[14,24,9,22],[14,25,9,23],[14,28,9,26],[14,32,9,26,"useState"],[14,38,9,34],[14,39,9,34,"useState"],[14,47,9,34],[14,49,9,35],[14,54,9,40],[14,55,9,41],[15,4,11,2],[15,10,11,8,"inflight"],[15,18,11,16],[15,21,11,19],[15,25,11,19,"useRef"],[15,31,11,25],[15,32,11,25,"useRef"],[15,38,11,25],[15,40,11,47],[15,44,11,51],[15,45,11,52],[16,4,13,2],[16,10,13,8,"loadMore"],[16,18,13,16],[16,21,13,19],[16,25,13,19,"useCallback"],[16,31,13,30],[16,32,13,30,"useCallback"],[16,43,13,30],[16,45,13,31],[16,57,13,43],[17,6,14,4],[17,10,14,8,"loading"],[17,17,14,15],[17,21,14,19,"done"],[17,25,14,23],[17,27,14,25],[18,6,15,4,"setLoading"],[18,16,15,14],[18,17,15,15],[18,21,15,19],[18,22,15,20],[19,6,16,4],[19,10,16,8],[20,8,17,6],[20,14,17,12,"p"],[20,15,17,13],[20,18,17,16],[20,22,17,16,"fetchStories"],[20,26,17,28],[20,27,17,28,"fetchStories"],[20,39,17,28],[20,41,17,29,"cursor"],[20,47,17,35],[20,49,17,37,"pageSize"],[20,57,17,45],[20,58,17,46],[21,8,18,6,"inflight"],[21,16,18,14],[21,17,18,15,"current"],[21,24,18,22],[21,27,18,25,"p"],[21,28,18,26],[22,8,19,6],[22,14,19,12,"res"],[22,17,19,15],[22,20,19,18],[22,26,19,24,"p"],[22,27,19,25],[23,8,20,6,"setStories"],[23,18,20,16],[23,19,20,18,"prev"],[23,23,20,22],[23,27,20,27],[23,28,20,28],[23,31,20,31,"prev"],[23,35,20,35],[23,37,20,37],[23,40,20,40,"res"],[23,43,20,43],[23,44,20,44,"data"],[23,48,20,48],[23,49,20,49],[23,50,20,50],[24,8,21,6,"setCursor"],[24,17,21,15],[24,18,21,16,"res"],[24,21,21,19],[24,22,21,20,"cursor"],[24,28,21,26],[24,32,21,30],[24,36,21,34],[24,37,21,35],[25,8,22,6],[25,12,22,10],[25,13,22,11,"res"],[25,16,22,14],[25,17,22,15,"cursor"],[25,23,22,21],[25,27,22,25,"res"],[25,30,22,28],[25,31,22,29,"data"],[25,35,22,33],[25,36,22,34,"length"],[25,42,22,40],[25,47,22,45],[25,48,22,46],[25,50,22,48,"setDone"],[25,57,22,55],[25,58,22,56],[25,62,22,60],[25,63,22,61],[26,6,23,4],[26,7,23,5],[26,16,23,14],[27,8,24,6,"inflight"],[27,16,24,14],[27,17,24,15,"current"],[27,24,24,22],[27,27,24,25],[27,31,24,29],[28,8,25,6,"setLoading"],[28,18,25,16],[28,19,25,17],[28,24,25,22],[28,25,25,23],[29,6,26,4],[30,4,27,2],[30,5,27,3],[30,7,27,5],[30,8,27,6,"cursor"],[30,14,27,12],[30,16,27,14,"done"],[30,20,27,18],[30,22,27,20,"loading"],[30,29,27,27],[30,31,27,29,"pageSize"],[30,39,27,37],[30,40,27,38],[30,41,27,39],[31,4,29,2],[31,8,29,2,"useEffect"],[31,14,29,11],[31,15,29,11,"useEffect"],[31,24,29,11],[31,26,29,12],[31,32,29,18],[32,6,29,20],[32,10,29,24,"stories"],[32,17,29,31],[32,18,29,32,"length"],[32,24,29,38],[32,29,29,43],[32,30,29,44],[32,32,29,46,"loadMore"],[32,40,29,54],[32,41,29,55],[32,42,29,56],[33,4,29,58],[33,5,29,59],[33,7,29,61],[33,9,29,63],[33,10,29,64],[33,11,29,65],[33,12,29,66],[35,4,31,2],[35,11,31,9],[36,6,31,11,"stories"],[36,13,31,18],[37,6,31,20,"loadMore"],[37,14,31,28],[38,6,31,30,"loading"],[38,13,31,37],[39,6,31,39,"done"],[40,4,31,44],[40,5,31,45],[41,2,32,0],[42,0,32,1],[42,3]],"functionMap":{"names":["<global>","useStoriesCursor","loadMore","setStories$argument_0","useEffect$argument_0"],"mappings":"AAA;OCI;+BCQ;iBCO,gCD;GDO;YGE,+CH"},"hasCjsExports":false},"type":"js/module"}]}