{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":65,"index":65}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":37,"index":103}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useStoriesCursor = useStoriesCursor;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2], \"react\");\n  var _api = require(_dependencyMap[3], \"./api\");\n  function useStoriesCursor() {\n    _s();\n    var initialCursor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var pageSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 24;\n    var _useState = (0, _react.useState)([]),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      stories = _useState2[0],\n      setStories = _useState2[1];\n    var _useState3 = (0, _react.useState)(initialCursor),\n      _useState4 = (0, _slicedToArray.default)(_useState3, 2),\n      cursor = _useState4[0],\n      setCursor = _useState4[1];\n    var _useState5 = (0, _react.useState)(false),\n      _useState6 = (0, _slicedToArray.default)(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n    var _useState7 = (0, _react.useState)(false),\n      _useState8 = (0, _slicedToArray.default)(_useState7, 2),\n      done = _useState8[0],\n      setDone = _useState8[1];\n    var inflight = (0, _react.useRef)(null);\n    var loadMore = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator.default)(function* () {\n      if (loading || done) return;\n      setLoading(true);\n      try {\n        var p = (0, _api.fetchStories)(cursor, pageSize);\n        inflight.current = p;\n        var res = yield p;\n        setStories(prev => [...prev, ...res.data]);\n        setCursor(res.cursor ?? null);\n        if (!res.cursor || res.data.length === 0) setDone(true);\n      } finally {\n        inflight.current = null;\n        setLoading(false);\n      }\n    }), [cursor, done, loading, pageSize]);\n    (0, _react.useEffect)(() => {\n      if (stories.length === 0) loadMore();\n    }, []); // initial\n\n    return {\n      stories,\n      loadMore,\n      loading,\n      done\n    };\n  }\n  _s(useStoriesCursor, \"5JnmqRw8Ouw9qUA1raTbjAHaxGs=\");\n});","lineCount":68,"map":[[13,2,5,0,"exports"],[13,9,5,0],[13,10,5,0,"useStoriesCursor"],[13,26,5,0],[13,29,5,0,"useStoriesCursor"],[13,45,5,0],[14,2,32,1],[14,6,32,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,42,32,1],[14,45,32,1,"require"],[14,52,32,1],[14,53,32,1,"_dependencyMap"],[14,67,32,1],[15,2,32,1],[15,6,32,1,"_asyncToGenerator"],[15,23,32,1],[15,26,32,1,"_interopDefault"],[15,41,32,1],[15,42,32,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,78,32,1],[16,2,32,1],[16,6,32,1,"_babelRuntimeHelpersSlicedToArray"],[16,39,32,1],[16,42,32,1,"require"],[16,49,32,1],[16,50,32,1,"_dependencyMap"],[16,64,32,1],[17,2,32,1],[17,6,32,1,"_slicedToArray"],[17,20,32,1],[17,23,32,1,"_interopDefault"],[17,38,32,1],[17,39,32,1,"_babelRuntimeHelpersSlicedToArray"],[17,72,32,1],[18,2,1,0],[18,6,1,0,"_react"],[18,12,1,0],[18,15,1,0,"require"],[18,22,1,0],[18,23,1,0,"_dependencyMap"],[18,37,1,0],[19,2,2,0],[19,6,2,0,"_api"],[19,10,2,0],[19,13,2,0,"require"],[19,20,2,0],[19,21,2,0,"_dependencyMap"],[19,35,2,0],[20,2,5,7],[20,11,5,16,"useStoriesCursor"],[20,27,5,32,"useStoriesCursor"],[20,28,5,32],[20,30,5,85],[21,4,5,85,"_s"],[21,6,5,85],[22,4,5,85],[22,8,5,33,"initialCursor"],[22,21,5,61],[22,24,5,61,"arguments"],[22,33,5,61],[22,34,5,61,"length"],[22,40,5,61],[22,48,5,61,"arguments"],[22,57,5,61],[22,65,5,61,"undefined"],[22,74,5,61],[22,77,5,61,"arguments"],[22,86,5,61],[22,92,5,64],[22,96,5,68],[23,4,5,68],[23,8,5,70,"pageSize"],[23,16,5,78],[23,19,5,78,"arguments"],[23,28,5,78],[23,29,5,78,"length"],[23,35,5,78],[23,43,5,78,"arguments"],[23,52,5,78],[23,60,5,78,"undefined"],[23,69,5,78],[23,72,5,78,"arguments"],[23,81,5,78],[23,87,5,81],[23,89,5,83],[24,4,6,2],[24,8,6,2,"_useState"],[24,17,6,2],[24,20,6,32],[24,24,6,32,"useState"],[24,30,6,40],[24,31,6,40,"useState"],[24,39,6,40],[24,41,6,50],[24,43,6,52],[24,44,6,53],[25,6,6,53,"_useState2"],[25,16,6,53],[25,23,6,53,"_slicedToArray"],[25,37,6,53],[25,38,6,53,"default"],[25,45,6,53],[25,47,6,53,"_useState"],[25,56,6,53],[26,6,6,9,"stories"],[26,13,6,16],[26,16,6,16,"_useState2"],[26,26,6,16],[27,6,6,18,"setStories"],[27,16,6,28],[27,19,6,28,"_useState2"],[27,29,6,28],[28,4,7,2],[28,8,7,2,"_useState3"],[28,18,7,2],[28,21,7,30],[28,25,7,30,"useState"],[28,31,7,38],[28,32,7,38,"useState"],[28,40,7,38],[28,42,7,54,"initialCursor"],[28,55,7,67],[28,56,7,68],[29,6,7,68,"_useState4"],[29,16,7,68],[29,23,7,68,"_slicedToArray"],[29,37,7,68],[29,38,7,68,"default"],[29,45,7,68],[29,47,7,68,"_useState3"],[29,57,7,68],[30,6,7,9,"cursor"],[30,12,7,15],[30,15,7,15,"_useState4"],[30,25,7,15],[31,6,7,17,"setCursor"],[31,15,7,26],[31,18,7,26,"_useState4"],[31,28,7,26],[32,4,8,2],[32,8,8,2,"_useState5"],[32,18,8,2],[32,21,8,32],[32,25,8,32,"useState"],[32,31,8,40],[32,32,8,40,"useState"],[32,40,8,40],[32,42,8,41],[32,47,8,46],[32,48,8,47],[33,6,8,47,"_useState6"],[33,16,8,47],[33,23,8,47,"_slicedToArray"],[33,37,8,47],[33,38,8,47,"default"],[33,45,8,47],[33,47,8,47,"_useState5"],[33,57,8,47],[34,6,8,9,"loading"],[34,13,8,16],[34,16,8,16,"_useState6"],[34,26,8,16],[35,6,8,18,"setLoading"],[35,16,8,28],[35,19,8,28,"_useState6"],[35,29,8,28],[36,4,9,2],[36,8,9,2,"_useState7"],[36,18,9,2],[36,21,9,26],[36,25,9,26,"useState"],[36,31,9,34],[36,32,9,34,"useState"],[36,40,9,34],[36,42,9,35],[36,47,9,40],[36,48,9,41],[37,6,9,41,"_useState8"],[37,16,9,41],[37,23,9,41,"_slicedToArray"],[37,37,9,41],[37,38,9,41,"default"],[37,45,9,41],[37,47,9,41,"_useState7"],[37,57,9,41],[38,6,9,9,"done"],[38,10,9,13],[38,13,9,13,"_useState8"],[38,23,9,13],[39,6,9,15,"setDone"],[39,13,9,22],[39,16,9,22,"_useState8"],[39,26,9,22],[40,4,11,2],[40,8,11,8,"inflight"],[40,16,11,16],[40,19,11,19],[40,23,11,19,"useRef"],[40,29,11,25],[40,30,11,25,"useRef"],[40,36,11,25],[40,38,11,47],[40,42,11,51],[40,43,11,52],[41,4,13,2],[41,8,13,8,"loadMore"],[41,16,13,16],[41,19,13,19],[41,23,13,19,"useCallback"],[41,29,13,30],[41,30,13,30,"useCallback"],[41,41,13,30],[41,60,13,30,"_asyncToGenerator"],[41,77,13,30],[41,78,13,30,"default"],[41,85,13,30],[41,87,13,31],[41,100,13,43],[42,6,14,4],[42,10,14,8,"loading"],[42,17,14,15],[42,21,14,19,"done"],[42,25,14,23],[42,27,14,25],[43,6,15,4,"setLoading"],[43,16,15,14],[43,17,15,15],[43,21,15,19],[43,22,15,20],[44,6,16,4],[44,10,16,8],[45,8,17,6],[45,12,17,12,"p"],[45,13,17,13],[45,16,17,16],[45,20,17,16,"fetchStories"],[45,24,17,28],[45,25,17,28,"fetchStories"],[45,37,17,28],[45,39,17,29,"cursor"],[45,45,17,35],[45,47,17,37,"pageSize"],[45,55,17,45],[45,56,17,46],[46,8,18,6,"inflight"],[46,16,18,14],[46,17,18,15,"current"],[46,24,18,22],[46,27,18,25,"p"],[46,28,18,26],[47,8,19,6],[47,12,19,12,"res"],[47,15,19,15],[47,24,19,24,"p"],[47,25,19,25],[48,8,20,6,"setStories"],[48,18,20,16],[48,19,20,18,"prev"],[48,23,20,22],[48,27,20,27],[48,28,20,28],[48,31,20,31,"prev"],[48,35,20,35],[48,37,20,37],[48,40,20,40,"res"],[48,43,20,43],[48,44,20,44,"data"],[48,48,20,48],[48,49,20,49],[48,50,20,50],[49,8,21,6,"setCursor"],[49,17,21,15],[49,18,21,16,"res"],[49,21,21,19],[49,22,21,20,"cursor"],[49,28,21,26],[49,32,21,30],[49,36,21,34],[49,37,21,35],[50,8,22,6],[50,12,22,10],[50,13,22,11,"res"],[50,16,22,14],[50,17,22,15,"cursor"],[50,23,22,21],[50,27,22,25,"res"],[50,30,22,28],[50,31,22,29,"data"],[50,35,22,33],[50,36,22,34,"length"],[50,42,22,40],[50,47,22,45],[50,48,22,46],[50,50,22,48,"setDone"],[50,57,22,55],[50,58,22,56],[50,62,22,60],[50,63,22,61],[51,6,23,4],[51,7,23,5],[51,16,23,14],[52,8,24,6,"inflight"],[52,16,24,14],[52,17,24,15,"current"],[52,24,24,22],[52,27,24,25],[52,31,24,29],[53,8,25,6,"setLoading"],[53,18,25,16],[53,19,25,17],[53,24,25,22],[53,25,25,23],[54,6,26,4],[55,4,27,2],[55,5,27,3],[55,8,27,5],[55,9,27,6,"cursor"],[55,15,27,12],[55,17,27,14,"done"],[55,21,27,18],[55,23,27,20,"loading"],[55,30,27,27],[55,32,27,29,"pageSize"],[55,40,27,37],[55,41,27,38],[55,42,27,39],[56,4,29,2],[56,8,29,2,"useEffect"],[56,14,29,11],[56,15,29,11,"useEffect"],[56,24,29,11],[56,26,29,12],[56,32,29,18],[57,6,29,20],[57,10,29,24,"stories"],[57,17,29,31],[57,18,29,32,"length"],[57,24,29,38],[57,29,29,43],[57,30,29,44],[57,32,29,46,"loadMore"],[57,40,29,54],[57,41,29,55],[57,42,29,56],[58,4,29,58],[58,5,29,59],[58,7,29,61],[58,9,29,63],[58,10,29,64],[58,11,29,65],[58,12,29,66],[60,4,31,2],[60,11,31,9],[61,6,31,11,"stories"],[61,13,31,18],[62,6,31,20,"loadMore"],[62,14,31,28],[63,6,31,30,"loading"],[63,13,31,37],[64,6,31,39,"done"],[65,4,31,44],[65,5,31,45],[66,2,32,0],[67,2,32,1,"_s"],[67,4,32,1],[67,5,5,16,"useStoriesCursor"],[67,21,5,32],[68,0,5,32],[68,3]],"functionMap":{"names":["<global>","useStoriesCursor","loadMore","setStories$argument_0","useEffect$argument_0"],"mappings":"AAA;OCI;+BCQ;iBCO,gCD;GDO;YGE,+CH"},"hasCjsExports":false},"type":"js/module"}]}