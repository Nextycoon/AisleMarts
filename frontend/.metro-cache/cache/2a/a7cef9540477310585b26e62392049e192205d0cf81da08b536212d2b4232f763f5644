{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":29},"end":{"line":2,"column":69,"index":98}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.hydrateCart = hydrateCart;\n  exports.loadLocalCart = loadLocalCart;\n  exports.persistCartToServer = persistCartToServer;\n  exports.saveLocalCart = saveLocalCart;\n  var _asyncStorage = _interopRequireDefault(require(_dependencyMap[1], \"@react-native-async-storage/async-storage\"));\n  // /app/frontend/lib/cart.ts\n\n  const CART_KEY = \"aisle.cart.v1\";\n  async function loadLocalCart() {\n    try {\n      const raw = await _asyncStorage.default.getItem(CART_KEY);\n      return raw ? JSON.parse(raw) : [];\n    } catch (error) {\n      console.error('Failed to load local cart:', error);\n      return [];\n    }\n  }\n  async function saveLocalCart(items) {\n    try {\n      await _asyncStorage.default.setItem(CART_KEY, JSON.stringify(items));\n    } catch (error) {\n      console.error('Failed to save local cart:', error);\n    }\n  }\n  async function persistCartToServer(items, deviceId) {\n    try {\n      await fetch(\"http://localhost:8000/api/cart/persist\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-Device-Id\": deviceId\n        },\n        body: JSON.stringify({\n          items\n        })\n      });\n    } catch (error) {\n      console.error('Failed to persist cart to server:', error);\n    }\n  }\n  async function hydrateCart(deviceId) {\n    try {\n      const local = await loadLocalCart();\n      await persistCartToServer(local, deviceId);\n      const response = await fetch(\"http://localhost:8000/api/cart/current\", {\n        headers: {\n          \"X-Device-Id\": deviceId\n        }\n      });\n      const data = await response.json();\n      const serverItems = data.items ?? [];\n      await saveLocalCart(serverItems);\n      return serverItems;\n    } catch (error) {\n      console.error('Failed to hydrate cart:', error);\n      return await loadLocalCart();\n    }\n  }\n});","lineCount":64,"map":[[10,2,2,0],[10,6,2,0,"_asyncStorage"],[10,19,2,0],[10,22,2,0,"_interopRequireDefault"],[10,44,2,0],[10,45,2,0,"require"],[10,52,2,0],[10,53,2,0,"_dependencyMap"],[10,67,2,0],[11,2,1,0],[13,2,5,0],[13,8,5,6,"CART_KEY"],[13,16,5,14],[13,19,5,17],[13,34,5,32],[14,2,9,7],[14,17,9,22,"loadLocalCart"],[14,30,9,35,"loadLocalCart"],[14,31,9,35],[14,33,9,59],[15,4,10,2],[15,8,10,6],[16,6,11,4],[16,12,11,10,"raw"],[16,15,11,13],[16,18,11,16],[16,24,11,22,"AsyncStorage"],[16,45,11,34],[16,46,11,35,"getItem"],[16,53,11,42],[16,54,11,43,"CART_KEY"],[16,62,11,51],[16,63,11,52],[17,6,12,4],[17,13,12,11,"raw"],[17,16,12,14],[17,19,12,17,"JSON"],[17,23,12,21],[17,24,12,22,"parse"],[17,29,12,27],[17,30,12,28,"raw"],[17,33,12,31],[17,34,12,32],[17,37,12,35],[17,39,12,37],[18,4,13,2],[18,5,13,3],[18,6,13,4],[18,13,13,11,"error"],[18,18,13,16],[18,20,13,18],[19,6,14,4,"console"],[19,13,14,11],[19,14,14,12,"error"],[19,19,14,17],[19,20,14,18],[19,48,14,46],[19,50,14,48,"error"],[19,55,14,53],[19,56,14,54],[20,6,15,4],[20,13,15,11],[20,15,15,13],[21,4,16,2],[22,2,17,0],[23,2,19,7],[23,17,19,22,"saveLocalCart"],[23,30,19,35,"saveLocalCart"],[23,31,19,36,"items"],[23,36,19,53],[23,38,19,55],[24,4,20,2],[24,8,20,6],[25,6,21,4],[25,12,21,10,"AsyncStorage"],[25,33,21,22],[25,34,21,23,"setItem"],[25,41,21,30],[25,42,21,31,"CART_KEY"],[25,50,21,39],[25,52,21,41,"JSON"],[25,56,21,45],[25,57,21,46,"stringify"],[25,66,21,55],[25,67,21,56,"items"],[25,72,21,61],[25,73,21,62],[25,74,21,63],[26,4,22,2],[26,5,22,3],[26,6,22,4],[26,13,22,11,"error"],[26,18,22,16],[26,20,22,18],[27,6,23,4,"console"],[27,13,23,11],[27,14,23,12,"error"],[27,19,23,17],[27,20,23,18],[27,48,23,46],[27,50,23,48,"error"],[27,55,23,53],[27,56,23,54],[28,4,24,2],[29,2,25,0],[30,2,27,7],[30,17,27,22,"persistCartToServer"],[30,36,27,41,"persistCartToServer"],[30,37,27,42,"items"],[30,42,27,59],[30,44,27,61,"deviceId"],[30,52,27,77],[30,54,27,79],[31,4,28,2],[31,8,28,6],[32,6,29,4],[32,12,29,10,"fetch"],[32,17,29,15],[32,18,29,16],[32,58,29,56],[32,60,29,58],[33,8,30,6,"method"],[33,14,30,12],[33,16,30,14],[33,22,30,20],[34,8,31,6,"headers"],[34,15,31,13],[34,17,31,15],[35,10,32,8],[35,24,32,22],[35,26,32,24],[35,44,32,42],[36,10,33,8],[36,23,33,21],[36,25,33,23,"deviceId"],[37,8,34,6],[37,9,34,7],[38,8,35,6,"body"],[38,12,35,10],[38,14,35,12,"JSON"],[38,18,35,16],[38,19,35,17,"stringify"],[38,28,35,26],[38,29,35,27],[39,10,35,29,"items"],[40,8,35,35],[40,9,35,36],[41,6,36,4],[41,7,36,5],[41,8,36,6],[42,4,37,2],[42,5,37,3],[42,6,37,4],[42,13,37,11,"error"],[42,18,37,16],[42,20,37,18],[43,6,38,4,"console"],[43,13,38,11],[43,14,38,12,"error"],[43,19,38,17],[43,20,38,18],[43,55,38,53],[43,57,38,55,"error"],[43,62,38,60],[43,63,38,61],[44,4,39,2],[45,2,40,0],[46,2,42,7],[46,17,42,22,"hydrateCart"],[46,28,42,33,"hydrateCart"],[46,29,42,34,"deviceId"],[46,37,42,50],[46,39,42,73],[47,4,43,2],[47,8,43,6],[48,6,44,4],[48,12,44,10,"local"],[48,17,44,15],[48,20,44,18],[48,26,44,24,"loadLocalCart"],[48,39,44,37],[48,40,44,38],[48,41,44,39],[49,6,45,4],[49,12,45,10,"persistCartToServer"],[49,31,45,29],[49,32,45,30,"local"],[49,37,45,35],[49,39,45,37,"deviceId"],[49,47,45,45],[49,48,45,46],[50,6,47,4],[50,12,47,10,"response"],[50,20,47,18],[50,23,47,21],[50,29,47,27,"fetch"],[50,34,47,32],[50,35,47,33],[50,75,47,73],[50,77,47,75],[51,8,48,6,"headers"],[51,15,48,13],[51,17,48,15],[52,10,48,17],[52,23,48,30],[52,25,48,32,"deviceId"],[53,8,48,41],[54,6,49,4],[54,7,49,5],[54,8,49,6],[55,6,50,4],[55,12,50,10,"data"],[55,16,50,14],[55,19,50,17],[55,25,50,23,"response"],[55,33,50,31],[55,34,50,32,"json"],[55,38,50,36],[55,39,50,37],[55,40,50,38],[56,6,52,4],[56,12,52,10,"serverItems"],[56,23,52,21],[56,26,52,24,"data"],[56,30,52,28],[56,31,52,29,"items"],[56,36,52,34],[56,40,52,38],[56,42,52,40],[57,6,53,4],[57,12,53,10,"saveLocalCart"],[57,25,53,23],[57,26,53,24,"serverItems"],[57,37,53,35],[57,38,53,36],[58,6,54,4],[58,13,54,11,"serverItems"],[58,24,54,22],[59,4,55,2],[59,5,55,3],[59,6,55,4],[59,13,55,11,"error"],[59,18,55,16],[59,20,55,18],[60,6,56,4,"console"],[60,13,56,11],[60,14,56,12,"error"],[60,19,56,17],[60,20,56,18],[60,45,56,43],[60,47,56,45,"error"],[60,52,56,50],[60,53,56,51],[61,6,57,4],[61,13,57,11],[61,19,57,17,"loadLocalCart"],[61,32,57,30],[61,33,57,31],[61,34,57,32],[62,4,58,2],[63,2,59,0],[64,0,59,1],[64,3]],"functionMap":{"names":["<global>","loadLocalCart","saveLocalCart","persistCartToServer","hydrateCart"],"mappings":"AAA;OCQ;CDQ;OEE;CFM;OGE;CHa;OIE"}},"type":"js/module"}]}