{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":29},"end":{"line":2,"column":69,"index":98}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.loadLocalCart = loadLocalCart;\n  exports.saveLocalCart = saveLocalCart;\n  exports.persistCartToServer = persistCartToServer;\n  exports.hydrateCart = hydrateCart;\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  // /app/frontend/lib/cart.ts\n\n  const CART_KEY = \"aisle.cart.v1\";\n  async function loadLocalCart() {\n    try {\n      const raw = await AsyncStorage.default.getItem(CART_KEY);\n      return raw ? JSON.parse(raw) : [];\n    } catch (error) {\n      console.error('Failed to load local cart:', error);\n      return [];\n    }\n  }\n  async function saveLocalCart(items) {\n    try {\n      await AsyncStorage.default.setItem(CART_KEY, JSON.stringify(items));\n    } catch (error) {\n      console.error('Failed to save local cart:', error);\n    }\n  }\n  async function persistCartToServer(items, deviceId) {\n    try {\n      await fetch(\"http://localhost:8000/api/cart/persist\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-Device-Id\": deviceId\n        },\n        body: JSON.stringify({\n          items\n        })\n      });\n    } catch (error) {\n      console.error('Failed to persist cart to server:', error);\n    }\n  }\n  async function hydrateCart(deviceId) {\n    try {\n      const local = await loadLocalCart();\n      await persistCartToServer(local, deviceId);\n      const response = await fetch(\"http://localhost:8000/api/cart/current\", {\n        headers: {\n          \"X-Device-Id\": deviceId\n        }\n      });\n      const data = await response.json();\n      const serverItems = data.items ?? [];\n      await saveLocalCart(serverItems);\n      return serverItems;\n    } catch (error) {\n      console.error('Failed to hydrate cart:', error);\n      return await loadLocalCart();\n    }\n  }\n});","lineCount":71,"map":[[12,2,9,0,"exports"],[12,9,9,0],[12,10,9,0,"loadLocalCart"],[12,23,9,0],[12,26,9,0,"loadLocalCart"],[12,39,9,0],[13,2,19,0,"exports"],[13,9,19,0],[13,10,19,0,"saveLocalCart"],[13,23,19,0],[13,26,19,0,"saveLocalCart"],[13,39,19,0],[14,2,27,0,"exports"],[14,9,27,0],[14,10,27,0,"persistCartToServer"],[14,29,27,0],[14,32,27,0,"persistCartToServer"],[14,51,27,0],[15,2,42,0,"exports"],[15,9,42,0],[15,10,42,0,"hydrateCart"],[15,21,42,0],[15,24,42,0,"hydrateCart"],[15,35,42,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,1,0],[20,2,5,0],[20,8,5,6,"CART_KEY"],[20,16,5,14],[20,19,5,17],[20,34,5,32],[21,2,9,7],[21,17,9,22,"loadLocalCart"],[21,30,9,35,"loadLocalCart"],[21,31,9,35],[21,33,9,59],[22,4,10,2],[22,8,10,6],[23,6,11,4],[23,12,11,10,"raw"],[23,15,11,13],[23,18,11,16],[23,24,11,22,"AsyncStorage"],[23,36,11,34],[23,37,11,34,"default"],[23,44,11,34],[23,45,11,35,"getItem"],[23,52,11,42],[23,53,11,43,"CART_KEY"],[23,61,11,51],[23,62,11,52],[24,6,12,4],[24,13,12,11,"raw"],[24,16,12,14],[24,19,12,17,"JSON"],[24,23,12,21],[24,24,12,22,"parse"],[24,29,12,27],[24,30,12,28,"raw"],[24,33,12,31],[24,34,12,32],[24,37,12,35],[24,39,12,37],[25,4,13,2],[25,5,13,3],[25,6,13,4],[25,13,13,11,"error"],[25,18,13,16],[25,20,13,18],[26,6,14,4,"console"],[26,13,14,11],[26,14,14,12,"error"],[26,19,14,17],[26,20,14,18],[26,48,14,46],[26,50,14,48,"error"],[26,55,14,53],[26,56,14,54],[27,6,15,4],[27,13,15,11],[27,15,15,13],[28,4,16,2],[29,2,17,0],[30,2,19,7],[30,17,19,22,"saveLocalCart"],[30,30,19,35,"saveLocalCart"],[30,31,19,36,"items"],[30,36,19,53],[30,38,19,55],[31,4,20,2],[31,8,20,6],[32,6,21,4],[32,12,21,10,"AsyncStorage"],[32,24,21,22],[32,25,21,22,"default"],[32,32,21,22],[32,33,21,23,"setItem"],[32,40,21,30],[32,41,21,31,"CART_KEY"],[32,49,21,39],[32,51,21,41,"JSON"],[32,55,21,45],[32,56,21,46,"stringify"],[32,65,21,55],[32,66,21,56,"items"],[32,71,21,61],[32,72,21,62],[32,73,21,63],[33,4,22,2],[33,5,22,3],[33,6,22,4],[33,13,22,11,"error"],[33,18,22,16],[33,20,22,18],[34,6,23,4,"console"],[34,13,23,11],[34,14,23,12,"error"],[34,19,23,17],[34,20,23,18],[34,48,23,46],[34,50,23,48,"error"],[34,55,23,53],[34,56,23,54],[35,4,24,2],[36,2,25,0],[37,2,27,7],[37,17,27,22,"persistCartToServer"],[37,36,27,41,"persistCartToServer"],[37,37,27,42,"items"],[37,42,27,59],[37,44,27,61,"deviceId"],[37,52,27,77],[37,54,27,79],[38,4,28,2],[38,8,28,6],[39,6,29,4],[39,12,29,10,"fetch"],[39,17,29,15],[39,18,29,16],[39,58,29,56],[39,60,29,58],[40,8,30,6,"method"],[40,14,30,12],[40,16,30,14],[40,22,30,20],[41,8,31,6,"headers"],[41,15,31,13],[41,17,31,15],[42,10,32,8],[42,24,32,22],[42,26,32,24],[42,44,32,42],[43,10,33,8],[43,23,33,21],[43,25,33,23,"deviceId"],[44,8,34,6],[44,9,34,7],[45,8,35,6,"body"],[45,12,35,10],[45,14,35,12,"JSON"],[45,18,35,16],[45,19,35,17,"stringify"],[45,28,35,26],[45,29,35,27],[46,10,35,29,"items"],[47,8,35,35],[47,9,35,36],[48,6,36,4],[48,7,36,5],[48,8,36,6],[49,4,37,2],[49,5,37,3],[49,6,37,4],[49,13,37,11,"error"],[49,18,37,16],[49,20,37,18],[50,6,38,4,"console"],[50,13,38,11],[50,14,38,12,"error"],[50,19,38,17],[50,20,38,18],[50,55,38,53],[50,57,38,55,"error"],[50,62,38,60],[50,63,38,61],[51,4,39,2],[52,2,40,0],[53,2,42,7],[53,17,42,22,"hydrateCart"],[53,28,42,33,"hydrateCart"],[53,29,42,34,"deviceId"],[53,37,42,50],[53,39,42,73],[54,4,43,2],[54,8,43,6],[55,6,44,4],[55,12,44,10,"local"],[55,17,44,15],[55,20,44,18],[55,26,44,24,"loadLocalCart"],[55,39,44,37],[55,40,44,38],[55,41,44,39],[56,6,45,4],[56,12,45,10,"persistCartToServer"],[56,31,45,29],[56,32,45,30,"local"],[56,37,45,35],[56,39,45,37,"deviceId"],[56,47,45,45],[56,48,45,46],[57,6,47,4],[57,12,47,10,"response"],[57,20,47,18],[57,23,47,21],[57,29,47,27,"fetch"],[57,34,47,32],[57,35,47,33],[57,75,47,73],[57,77,47,75],[58,8,48,6,"headers"],[58,15,48,13],[58,17,48,15],[59,10,48,17],[59,23,48,30],[59,25,48,32,"deviceId"],[60,8,48,41],[61,6,49,4],[61,7,49,5],[61,8,49,6],[62,6,50,4],[62,12,50,10,"data"],[62,16,50,14],[62,19,50,17],[62,25,50,23,"response"],[62,33,50,31],[62,34,50,32,"json"],[62,38,50,36],[62,39,50,37],[62,40,50,38],[63,6,52,4],[63,12,52,10,"serverItems"],[63,23,52,21],[63,26,52,24,"data"],[63,30,52,28],[63,31,52,29,"items"],[63,36,52,34],[63,40,52,38],[63,42,52,40],[64,6,53,4],[64,12,53,10,"saveLocalCart"],[64,25,53,23],[64,26,53,24,"serverItems"],[64,37,53,35],[64,38,53,36],[65,6,54,4],[65,13,54,11,"serverItems"],[65,24,54,22],[66,4,55,2],[66,5,55,3],[66,6,55,4],[66,13,55,11,"error"],[66,18,55,16],[66,20,55,18],[67,6,56,4,"console"],[67,13,56,11],[67,14,56,12,"error"],[67,19,56,17],[67,20,56,18],[67,45,56,43],[67,47,56,45,"error"],[67,52,56,50],[67,53,56,51],[68,6,57,4],[68,13,57,11],[68,19,57,17,"loadLocalCart"],[68,32,57,30],[68,33,57,31],[68,34,57,32],[69,4,58,2],[70,2,59,0],[71,0,59,1],[71,3]],"functionMap":{"names":["<global>","loadLocalCart","saveLocalCart","persistCartToServer","hydrateCart"],"mappings":"AAA;OCQ;CDQ;OEE;CFM;OGE;CHa;OIE"},"hasCjsExports":false},"type":"js/module"}]}