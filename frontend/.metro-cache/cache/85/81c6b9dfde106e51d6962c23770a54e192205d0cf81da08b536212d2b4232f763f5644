{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":29},"end":{"line":2,"column":69,"index":98}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.loadLocalCart = loadLocalCart;\n  exports.saveLocalCart = saveLocalCart;\n  exports.persistCartToServer = persistCartToServer;\n  exports.hydrateCart = hydrateCart;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  // /app/frontend/lib/cart.ts\n\n  var CART_KEY = \"aisle.cart.v1\";\n  function loadLocalCart() {\n    return _loadLocalCart.apply(this, arguments);\n  }\n  function _loadLocalCart() {\n    _loadLocalCart = (0, _asyncToGenerator.default)(function* () {\n      try {\n        var raw = yield AsyncStorage.default.getItem(CART_KEY);\n        return raw ? JSON.parse(raw) : [];\n      } catch (error) {\n        console.error('Failed to load local cart:', error);\n        return [];\n      }\n    });\n    return _loadLocalCart.apply(this, arguments);\n  }\n  function saveLocalCart(_x) {\n    return _saveLocalCart.apply(this, arguments);\n  }\n  function _saveLocalCart() {\n    _saveLocalCart = (0, _asyncToGenerator.default)(function* (items) {\n      try {\n        yield AsyncStorage.default.setItem(CART_KEY, JSON.stringify(items));\n      } catch (error) {\n        console.error('Failed to save local cart:', error);\n      }\n    });\n    return _saveLocalCart.apply(this, arguments);\n  }\n  function persistCartToServer(_x2, _x3) {\n    return _persistCartToServer.apply(this, arguments);\n  }\n  function _persistCartToServer() {\n    _persistCartToServer = (0, _asyncToGenerator.default)(function* (items, deviceId) {\n      try {\n        yield fetch(\"http://localhost:8000/api/cart/persist\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"X-Device-Id\": deviceId\n          },\n          body: JSON.stringify({\n            items\n          })\n        });\n      } catch (error) {\n        console.error('Failed to persist cart to server:', error);\n      }\n    });\n    return _persistCartToServer.apply(this, arguments);\n  }\n  function hydrateCart(_x4) {\n    return _hydrateCart.apply(this, arguments);\n  }\n  function _hydrateCart() {\n    _hydrateCart = (0, _asyncToGenerator.default)(function* (deviceId) {\n      try {\n        var local = yield loadLocalCart();\n        yield persistCartToServer(local, deviceId);\n        var response = yield fetch(\"http://localhost:8000/api/cart/current\", {\n          headers: {\n            \"X-Device-Id\": deviceId\n          }\n        });\n        var data = yield response.json();\n        var serverItems = data.items ?? [];\n        yield saveLocalCart(serverItems);\n        return serverItems;\n      } catch (error) {\n        console.error('Failed to hydrate cart:', error);\n        return yield loadLocalCart();\n      }\n    });\n    return _hydrateCart.apply(this, arguments);\n  }\n});","lineCount":97,"map":[[12,2,9,0,"exports"],[12,9,9,0],[12,10,9,0,"loadLocalCart"],[12,23,9,0],[12,26,9,0,"loadLocalCart"],[12,39,9,0],[13,2,19,0,"exports"],[13,9,19,0],[13,10,19,0,"saveLocalCart"],[13,23,19,0],[13,26,19,0,"saveLocalCart"],[13,39,19,0],[14,2,27,0,"exports"],[14,9,27,0],[14,10,27,0,"persistCartToServer"],[14,29,27,0],[14,32,27,0,"persistCartToServer"],[14,51,27,0],[15,2,42,0,"exports"],[15,9,42,0],[15,10,42,0,"hydrateCart"],[15,21,42,0],[15,24,42,0,"hydrateCart"],[15,35,42,0],[16,2,59,1],[16,6,59,1,"_babelRuntimeHelpersAsyncToGenerator"],[16,42,59,1],[16,45,59,1,"require"],[16,52,59,1],[16,53,59,1,"_dependencyMap"],[16,67,59,1],[17,2,59,1],[17,6,59,1,"_asyncToGenerator"],[17,23,59,1],[17,26,59,1,"_interopDefault"],[17,41,59,1],[17,42,59,1,"_babelRuntimeHelpersAsyncToGenerator"],[17,78,59,1],[18,2,2,0],[18,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,2,0],[18,45,2,0,"require"],[18,52,2,0],[18,53,2,0,"_dependencyMap"],[18,67,2,0],[19,2,2,0],[19,6,2,0,"AsyncStorage"],[19,18,2,0],[19,21,2,0,"_interopDefault"],[19,36,2,0],[19,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,2,0],[20,2,1,0],[22,2,5,0],[22,6,5,6,"CART_KEY"],[22,14,5,14],[22,17,5,17],[22,32,5,32],[23,2,5,33],[23,11,9,22,"loadLocalCart"],[23,24,9,35,"loadLocalCart"],[23,25,9,35],[24,4,9,35],[24,11,9,35,"_loadLocalCart"],[24,25,9,35],[24,26,9,35,"apply"],[24,31,9,35],[24,38,9,35,"arguments"],[24,47,9,35],[25,2,9,35],[26,2,9,35],[26,11,9,35,"_loadLocalCart"],[26,26,9,35],[27,4,9,35,"_loadLocalCart"],[27,18,9,35],[27,25,9,35,"_asyncToGenerator"],[27,42,9,35],[27,43,9,35,"default"],[27,50,9,35],[27,52,9,7],[27,65,9,59],[28,6,10,2],[28,10,10,6],[29,8,11,4],[29,12,11,10,"raw"],[29,15,11,13],[29,24,11,22,"AsyncStorage"],[29,36,11,34],[29,37,11,34,"default"],[29,44,11,34],[29,45,11,35,"getItem"],[29,52,11,42],[29,53,11,43,"CART_KEY"],[29,61,11,51],[29,62,11,52],[30,8,12,4],[30,15,12,11,"raw"],[30,18,12,14],[30,21,12,17,"JSON"],[30,25,12,21],[30,26,12,22,"parse"],[30,31,12,27],[30,32,12,28,"raw"],[30,35,12,31],[30,36,12,32],[30,39,12,35],[30,41,12,37],[31,6,13,2],[31,7,13,3],[31,8,13,4],[31,15,13,11,"error"],[31,20,13,16],[31,22,13,18],[32,8,14,4,"console"],[32,15,14,11],[32,16,14,12,"error"],[32,21,14,17],[32,22,14,18],[32,50,14,46],[32,52,14,48,"error"],[32,57,14,53],[32,58,14,54],[33,8,15,4],[33,15,15,11],[33,17,15,13],[34,6,16,2],[35,4,17,0],[35,5,17,1],[36,4,17,1],[36,11,17,1,"_loadLocalCart"],[36,25,17,1],[36,26,17,1,"apply"],[36,31,17,1],[36,38,17,1,"arguments"],[36,47,17,1],[37,2,17,1],[38,2,17,1],[38,11,19,22,"saveLocalCart"],[38,24,19,35,"saveLocalCart"],[38,25,19,35,"_x"],[38,27,19,35],[39,4,19,35],[39,11,19,35,"_saveLocalCart"],[39,25,19,35],[39,26,19,35,"apply"],[39,31,19,35],[39,38,19,35,"arguments"],[39,47,19,35],[40,2,19,35],[41,2,19,35],[41,11,19,35,"_saveLocalCart"],[41,26,19,35],[42,4,19,35,"_saveLocalCart"],[42,18,19,35],[42,25,19,35,"_asyncToGenerator"],[42,42,19,35],[42,43,19,35,"default"],[42,50,19,35],[42,52,19,7],[42,63,19,36,"items"],[42,68,19,53],[42,70,19,55],[43,6,20,2],[43,10,20,6],[44,8,21,4],[44,14,21,10,"AsyncStorage"],[44,26,21,22],[44,27,21,22,"default"],[44,34,21,22],[44,35,21,23,"setItem"],[44,42,21,30],[44,43,21,31,"CART_KEY"],[44,51,21,39],[44,53,21,41,"JSON"],[44,57,21,45],[44,58,21,46,"stringify"],[44,67,21,55],[44,68,21,56,"items"],[44,73,21,61],[44,74,21,62],[44,75,21,63],[45,6,22,2],[45,7,22,3],[45,8,22,4],[45,15,22,11,"error"],[45,20,22,16],[45,22,22,18],[46,8,23,4,"console"],[46,15,23,11],[46,16,23,12,"error"],[46,21,23,17],[46,22,23,18],[46,50,23,46],[46,52,23,48,"error"],[46,57,23,53],[46,58,23,54],[47,6,24,2],[48,4,25,0],[48,5,25,1],[49,4,25,1],[49,11,25,1,"_saveLocalCart"],[49,25,25,1],[49,26,25,1,"apply"],[49,31,25,1],[49,38,25,1,"arguments"],[49,47,25,1],[50,2,25,1],[51,2,25,1],[51,11,27,22,"persistCartToServer"],[51,30,27,41,"persistCartToServer"],[51,31,27,41,"_x2"],[51,34,27,41],[51,36,27,41,"_x3"],[51,39,27,41],[52,4,27,41],[52,11,27,41,"_persistCartToServer"],[52,31,27,41],[52,32,27,41,"apply"],[52,37,27,41],[52,44,27,41,"arguments"],[52,53,27,41],[53,2,27,41],[54,2,27,41],[54,11,27,41,"_persistCartToServer"],[54,32,27,41],[55,4,27,41,"_persistCartToServer"],[55,24,27,41],[55,31,27,41,"_asyncToGenerator"],[55,48,27,41],[55,49,27,41,"default"],[55,56,27,41],[55,58,27,7],[55,69,27,42,"items"],[55,74,27,59],[55,76,27,61,"deviceId"],[55,84,27,77],[55,86,27,79],[56,6,28,2],[56,10,28,6],[57,8,29,4],[57,14,29,10,"fetch"],[57,19,29,15],[57,20,29,16],[57,60,29,56],[57,62,29,58],[58,10,30,6,"method"],[58,16,30,12],[58,18,30,14],[58,24,30,20],[59,10,31,6,"headers"],[59,17,31,13],[59,19,31,15],[60,12,32,8],[60,26,32,22],[60,28,32,24],[60,46,32,42],[61,12,33,8],[61,25,33,21],[61,27,33,23,"deviceId"],[62,10,34,6],[62,11,34,7],[63,10,35,6,"body"],[63,14,35,10],[63,16,35,12,"JSON"],[63,20,35,16],[63,21,35,17,"stringify"],[63,30,35,26],[63,31,35,27],[64,12,35,29,"items"],[65,10,35,35],[65,11,35,36],[66,8,36,4],[66,9,36,5],[66,10,36,6],[67,6,37,2],[67,7,37,3],[67,8,37,4],[67,15,37,11,"error"],[67,20,37,16],[67,22,37,18],[68,8,38,4,"console"],[68,15,38,11],[68,16,38,12,"error"],[68,21,38,17],[68,22,38,18],[68,57,38,53],[68,59,38,55,"error"],[68,64,38,60],[68,65,38,61],[69,6,39,2],[70,4,40,0],[70,5,40,1],[71,4,40,1],[71,11,40,1,"_persistCartToServer"],[71,31,40,1],[71,32,40,1,"apply"],[71,37,40,1],[71,44,40,1,"arguments"],[71,53,40,1],[72,2,40,1],[73,2,40,1],[73,11,42,22,"hydrateCart"],[73,22,42,33,"hydrateCart"],[73,23,42,33,"_x4"],[73,26,42,33],[74,4,42,33],[74,11,42,33,"_hydrateCart"],[74,23,42,33],[74,24,42,33,"apply"],[74,29,42,33],[74,36,42,33,"arguments"],[74,45,42,33],[75,2,42,33],[76,2,42,33],[76,11,42,33,"_hydrateCart"],[76,24,42,33],[77,4,42,33,"_hydrateCart"],[77,16,42,33],[77,23,42,33,"_asyncToGenerator"],[77,40,42,33],[77,41,42,33,"default"],[77,48,42,33],[77,50,42,7],[77,61,42,34,"deviceId"],[77,69,42,50],[77,71,42,73],[78,6,43,2],[78,10,43,6],[79,8,44,4],[79,12,44,10,"local"],[79,17,44,15],[79,26,44,24,"loadLocalCart"],[79,39,44,37],[79,40,44,38],[79,41,44,39],[80,8,45,4],[80,14,45,10,"persistCartToServer"],[80,33,45,29],[80,34,45,30,"local"],[80,39,45,35],[80,41,45,37,"deviceId"],[80,49,45,45],[80,50,45,46],[81,8,47,4],[81,12,47,10,"response"],[81,20,47,18],[81,29,47,27,"fetch"],[81,34,47,32],[81,35,47,33],[81,75,47,73],[81,77,47,75],[82,10,48,6,"headers"],[82,17,48,13],[82,19,48,15],[83,12,48,17],[83,25,48,30],[83,27,48,32,"deviceId"],[84,10,48,41],[85,8,49,4],[85,9,49,5],[85,10,49,6],[86,8,50,4],[86,12,50,10,"data"],[86,16,50,14],[86,25,50,23,"response"],[86,33,50,31],[86,34,50,32,"json"],[86,38,50,36],[86,39,50,37],[86,40,50,38],[87,8,52,4],[87,12,52,10,"serverItems"],[87,23,52,21],[87,26,52,24,"data"],[87,30,52,28],[87,31,52,29,"items"],[87,36,52,34],[87,40,52,38],[87,42,52,40],[88,8,53,4],[88,14,53,10,"saveLocalCart"],[88,27,53,23],[88,28,53,24,"serverItems"],[88,39,53,35],[88,40,53,36],[89,8,54,4],[89,15,54,11,"serverItems"],[89,26,54,22],[90,6,55,2],[90,7,55,3],[90,8,55,4],[90,15,55,11,"error"],[90,20,55,16],[90,22,55,18],[91,8,56,4,"console"],[91,15,56,11],[91,16,56,12,"error"],[91,21,56,17],[91,22,56,18],[91,47,56,43],[91,49,56,45,"error"],[91,54,56,50],[91,55,56,51],[92,8,57,4],[92,21,57,17,"loadLocalCart"],[92,34,57,30],[92,35,57,31],[92,36,57,32],[93,6,58,2],[94,4,59,0],[94,5,59,1],[95,4,59,1],[95,11,59,1,"_hydrateCart"],[95,23,59,1],[95,24,59,1,"apply"],[95,29,59,1],[95,36,59,1,"arguments"],[95,45,59,1],[96,2,59,1],[97,0,59,1],[97,3]],"functionMap":{"names":["<global>","loadLocalCart","saveLocalCart","persistCartToServer","hydrateCart"],"mappings":"AAA;OCQ;CDQ;OEE;CFM;OGE;CHa;OIE"},"hasCjsExports":false},"type":"js/module"}]}