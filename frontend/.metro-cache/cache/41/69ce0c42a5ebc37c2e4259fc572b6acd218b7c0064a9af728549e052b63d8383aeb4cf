{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":81,"index":81}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/FlatList","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"DmaJKCBnIi5ZEPZkQdrt7FKBDEo=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/View","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"4kYBDC6LJJXoH7P9rWDi3vkLVB0=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Dimensions","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"ySrYx/xxJL+A+Ie+sLy/r/EEnF8=","exportNames":["*"],"imports":1}},{"name":"../lib/PrefetchCoordinator","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":152},"end":{"line":3,"column":65,"index":217}}],"key":"fxESIL0Vs+yHuGJWuxQHmLeHfpE=","exportNames":["*"],"imports":1}},{"name":"../components/PerfHUD","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":218},"end":{"line":4,"column":48,"index":266}}],"key":"zwBDOWOPpuFt3YJT1fYEAuvHuT0=","exportNames":["*"],"imports":1}},{"name":"../components/StoryCard","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":267},"end":{"line":5,"column":52,"index":319}}],"key":"WmPg7P1aUfwoCfSMyKym8fUbZE4=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/app/stories/StoriesScreen.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return StoriesScreen;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeWebDistExportsFlatList = require(_dependencyMap[1], \"react-native-web/dist/exports/FlatList\");\n  var FlatList = _interopDefault(_reactNativeWebDistExportsFlatList);\n  var _reactNativeWebDistExportsView = require(_dependencyMap[2], \"react-native-web/dist/exports/View\");\n  var View = _interopDefault(_reactNativeWebDistExportsView);\n  var _reactNativeWebDistExportsDimensions = require(_dependencyMap[3], \"react-native-web/dist/exports/Dimensions\");\n  var Dimensions = _interopDefault(_reactNativeWebDistExportsDimensions);\n  var _libPrefetchCoordinator = require(_dependencyMap[4], \"../lib/PrefetchCoordinator\");\n  var _componentsPerfHUD = require(_dependencyMap[5], \"../components/PerfHUD\");\n  var _componentsStoryCard = require(_dependencyMap[6], \"../components/StoryCard\");\n  var _reactJsxDevRuntime = require(_dependencyMap[7], \"react/jsx-dev-runtime\");\n  const {\n    width\n  } = Dimensions.default.get('window');\n  function StoriesScreen({\n    stories\n  }) {\n    const [visibleIndex, setVisibleIndex] = (0, _react.useState)(0);\n\n    // --- Prefetcher (3-item lookahead with video support)\n    const prefetchRef = (0, _react.useRef)(new _libPrefetchCoordinator.PrefetchCoordinator(stories, 3)).current;\n    (0, _react.useEffect)(() => {\n      prefetchRef.attachGlobal();\n      prefetchRef.updateStories(stories);\n    }, [stories]);\n\n    // --- Viewability â†’ inform prefetch focus & track visible videos\n    const viewabilityConfig = (0, _react.useMemo)(() => ({\n      itemVisiblePercentThreshold: 80\n    }), []);\n    const onViewableItemsChanged = (0, _react.useRef)(({\n      viewableItems\n    }) => {\n      const idx = viewableItems[0]?.index ?? 0;\n      setVisibleIndex(idx);\n      prefetchRef.focus(idx);\n      globalThis.__visibleIndex = idx;\n    }).current;\n    const renderItem = (0, _react.useCallback)(({\n      item,\n      index\n    }) => /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_componentsStoryCard.StoryCard, {\n      story: {\n        ...item,\n        __visible: index === visibleIndex\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 5\n    }, this), [visibleIndex]);\n    const getItemLayout = (0, _react.useCallback)((_, i) => ({\n      length: width,\n      offset: width * i,\n      index: i\n    }), []);\n    const onEndReached = (0, _react.useCallback)(() => {\n      // trigger pagination; backend already supports cursor\n      // fetchMore();\n    }, []);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(View.default, {\n      style: {\n        flex: 1,\n        backgroundColor: '#1A1A1A'\n      },\n      children: [/*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(FlatList.default, {\n        data: stories,\n        renderItem: renderItem,\n        keyExtractor: s => s.id,\n        horizontal: true,\n        pagingEnabled: true,\n        showsHorizontalScrollIndicator: false,\n        windowSize: 5,\n        initialNumToRender: 3,\n        maxToRenderPerBatch: 4,\n        updateCellsBatchingPeriod: 50,\n        removeClippedSubviews: true,\n        overScrollMode: \"never\",\n        viewabilityConfig: viewabilityConfig,\n        onViewableItemsChanged: onViewableItemsChanged,\n        getItemLayout: getItemLayout,\n        onEndReached: onEndReached,\n        onEndReachedThreshold: 0.7\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 7\n      }, this), process.env.EXPO_PUBLIC_SHOW_PERF_HUD === \"1\" && /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_componentsPerfHUD.PerfHUD, {\n        creators: 1,\n        stories: stories.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }, this);\n  }\n});","lineCount":120,"map":[[13,2,11,15,"Object"],[13,8,11,15],[13,9,11,15,"defineProperty"],[13,23,11,15],[13,24,11,15,"exports"],[13,31,11,15],[14,4,11,15,"enumerable"],[14,14,11,15],[15,4,11,15,"get"],[15,7,11,15],[15,18,11,15,"get"],[15,19,11,15],[16,6,11,15],[16,13,11,15,"StoriesScreen"],[16,26,11,15],[17,4,11,15],[18,2,11,15],[19,2,1,0],[19,6,1,0,"_react"],[19,12,1,0],[19,15,1,0,"require"],[19,22,1,0],[19,23,1,0,"_dependencyMap"],[19,37,1,0],[20,2,1,81],[20,6,1,81,"_reactNativeWebDistExportsFlatList"],[20,40,1,81],[20,43,1,81,"require"],[20,50,1,81],[20,51,1,81,"_dependencyMap"],[20,65,1,81],[21,2,1,81],[21,6,1,81,"FlatList"],[21,14,1,81],[21,17,1,81,"_interopDefault"],[21,32,1,81],[21,33,1,81,"_reactNativeWebDistExportsFlatList"],[21,67,1,81],[22,2,1,81],[22,6,1,81,"_reactNativeWebDistExportsView"],[22,36,1,81],[22,39,1,81,"require"],[22,46,1,81],[22,47,1,81,"_dependencyMap"],[22,61,1,81],[23,2,1,81],[23,6,1,81,"View"],[23,10,1,81],[23,13,1,81,"_interopDefault"],[23,28,1,81],[23,29,1,81,"_reactNativeWebDistExportsView"],[23,59,1,81],[24,2,1,81],[24,6,1,81,"_reactNativeWebDistExportsDimensions"],[24,42,1,81],[24,45,1,81,"require"],[24,52,1,81],[24,53,1,81,"_dependencyMap"],[24,67,1,81],[25,2,1,81],[25,6,1,81,"Dimensions"],[25,16,1,81],[25,19,1,81,"_interopDefault"],[25,34,1,81],[25,35,1,81,"_reactNativeWebDistExportsDimensions"],[25,71,1,81],[26,2,3,0],[26,6,3,0,"_libPrefetchCoordinator"],[26,29,3,0],[26,32,3,0,"require"],[26,39,3,0],[26,40,3,0,"_dependencyMap"],[26,54,3,0],[27,2,4,0],[27,6,4,0,"_componentsPerfHUD"],[27,24,4,0],[27,27,4,0,"require"],[27,34,4,0],[27,35,4,0,"_dependencyMap"],[27,49,4,0],[28,2,5,0],[28,6,5,0,"_componentsStoryCard"],[28,26,5,0],[28,29,5,0,"require"],[28,36,5,0],[28,37,5,0,"_dependencyMap"],[28,51,5,0],[29,2,5,52],[29,6,5,52,"_reactJsxDevRuntime"],[29,25,5,52],[29,28,5,52,"require"],[29,35,5,52],[29,36,5,52,"_dependencyMap"],[29,50,5,52],[30,2,7,0],[30,8,7,6],[31,4,7,8,"width"],[32,2,7,14],[32,3,7,15],[32,6,7,18,"Dimensions"],[32,16,7,28],[32,17,7,28,"default"],[32,24,7,28],[32,25,7,29,"get"],[32,28,7,32],[32,29,7,33],[32,37,7,41],[32,38,7,42],[33,2,11,15],[33,11,11,24,"StoriesScreen"],[33,24,11,37,"StoriesScreen"],[33,25,11,38],[34,4,11,40,"stories"],[35,2,11,70],[35,3,11,71],[35,5,11,73],[36,4,12,2],[36,10,12,8],[36,11,12,9,"visibleIndex"],[36,23,12,21],[36,25,12,23,"setVisibleIndex"],[36,40,12,38],[36,41,12,39],[36,44,12,42],[36,48,12,42,"useState"],[36,54,12,50],[36,55,12,50,"useState"],[36,63,12,50],[36,65,12,51],[36,66,12,52],[36,67,12,53],[38,4,14,2],[39,4,15,2],[39,10,15,8,"prefetchRef"],[39,21,15,19],[39,24,15,22],[39,28,15,22,"useRef"],[39,34,15,28],[39,35,15,28,"useRef"],[39,41,15,28],[39,43,15,29],[39,47,15,33,"PrefetchCoordinator"],[39,70,15,52],[39,71,15,52,"PrefetchCoordinator"],[39,90,15,52],[39,91,15,53,"stories"],[39,98,15,60],[39,100,15,62],[39,101,15,63],[39,102,15,64],[39,103,15,65],[39,104,15,66,"current"],[39,111,15,73],[40,4,16,2],[40,8,16,2,"useEffect"],[40,14,16,11],[40,15,16,11,"useEffect"],[40,24,16,11],[40,26,16,12],[40,32,16,18],[41,6,17,4,"prefetchRef"],[41,17,17,15],[41,18,17,16,"attachGlobal"],[41,30,17,28],[41,31,17,29],[41,32,17,30],[42,6,18,4,"prefetchRef"],[42,17,18,15],[42,18,18,16,"updateStories"],[42,31,18,29],[42,32,18,30,"stories"],[42,39,18,37],[42,40,18,38],[43,4,19,2],[43,5,19,3],[43,7,19,5],[43,8,19,6,"stories"],[43,15,19,13],[43,16,19,14],[43,17,19,15],[45,4,21,2],[46,4,22,2],[46,10,22,8,"viewabilityConfig"],[46,27,22,25],[46,30,22,28],[46,34,22,28,"useMemo"],[46,40,22,35],[46,41,22,35,"useMemo"],[46,48,22,35],[46,50,22,36],[46,57,22,43],[47,6,22,45,"itemVisiblePercentThreshold"],[47,33,22,72],[47,35,22,74],[48,4,22,77],[48,5,22,78],[48,6,22,79],[48,8,22,81],[48,10,22,83],[48,11,22,84],[49,4,23,2],[49,10,23,8,"onViewableItemsChanged"],[49,32,23,30],[49,35,23,33],[49,39,23,33,"useRef"],[49,45,23,39],[49,46,23,39,"useRef"],[49,52,23,39],[49,54,24,4],[49,55,24,5],[50,6,24,7,"viewableItems"],[51,4,24,53],[51,5,24,54],[51,10,24,59],[52,6,25,6],[52,12,25,12,"idx"],[52,15,25,15],[52,18,25,18,"viewableItems"],[52,31,25,31],[52,32,25,32],[52,33,25,33],[52,34,25,34],[52,36,25,36,"index"],[52,41,25,41],[52,45,25,45],[52,46,25,46],[53,6,26,6,"setVisibleIndex"],[53,21,26,21],[53,22,26,22,"idx"],[53,25,26,25],[53,26,26,26],[54,6,27,6,"prefetchRef"],[54,17,27,17],[54,18,27,18,"focus"],[54,23,27,23],[54,24,27,24,"idx"],[54,27,27,27],[54,28,27,28],[55,6,28,7,"globalThis"],[55,16,28,17],[55,17,28,26,"__visibleIndex"],[55,31,28,40],[55,34,28,43,"idx"],[55,37,28,46],[56,4,29,4],[56,5,30,2],[56,6,30,3],[56,7,30,4,"current"],[56,14,30,11],[57,4,32,2],[57,10,32,8,"renderItem"],[57,20,32,18],[57,23,32,21],[57,27,32,21,"useCallback"],[57,33,32,32],[57,34,32,32,"useCallback"],[57,45,32,32],[57,47,32,33],[57,48,32,34],[58,6,32,36,"item"],[58,10,32,40],[59,6,32,42,"index"],[60,4,32,80],[60,5,32,81],[60,23,33,4],[60,27,33,4,"_reactJsxDevRuntime"],[60,46,33,4],[60,47,33,4,"jsxDEV"],[60,53,33,4],[60,55,33,5,"_componentsStoryCard"],[60,75,33,14],[60,76,33,14,"StoryCard"],[60,85,33,14],[61,6,33,15,"story"],[61,11,33,20],[61,13,33,22],[62,8,33,24],[62,11,33,27,"item"],[62,15,33,31],[63,8,33,33,"__visible"],[63,17,33,42],[63,19,33,44,"index"],[63,24,33,49],[63,29,33,54,"visibleIndex"],[64,6,33,67],[65,4,33,69],[66,6,33,69,"fileName"],[66,14,33,69],[66,16,33,69,"_jsxFileName"],[66,28,33,69],[67,6,33,69,"lineNumber"],[67,16,33,69],[68,6,33,69,"columnNumber"],[68,18,33,69],[69,4,33,69],[69,11,33,71],[69,12,34,3],[69,14,34,5],[69,15,34,6,"visibleIndex"],[69,27,34,18],[69,28,34,19],[69,29,34,20],[70,4,36,2],[70,10,36,8,"getItemLayout"],[70,23,36,21],[70,26,36,24],[70,30,36,24,"useCallback"],[70,36,36,35],[70,37,36,35,"useCallback"],[70,48,36,35],[70,50,36,36],[70,51,36,37,"_"],[70,52,36,43],[70,54,36,45,"i"],[70,55,36,54],[70,61,37,4],[71,6,37,6,"length"],[71,12,37,12],[71,14,37,14,"width"],[71,19,37,19],[72,6,37,21,"offset"],[72,12,37,27],[72,14,37,29,"width"],[72,19,37,34],[72,22,37,37,"i"],[72,23,37,38],[73,6,37,40,"index"],[73,11,37,45],[73,13,37,47,"i"],[74,4,37,49],[74,5,37,50],[74,6,38,3],[74,8,38,5],[74,10,38,7],[74,11,38,8],[75,4,40,2],[75,10,40,8,"onEndReached"],[75,22,40,20],[75,25,40,23],[75,29,40,23,"useCallback"],[75,35,40,34],[75,36,40,34,"useCallback"],[75,47,40,34],[75,49,40,35],[75,55,40,41],[76,6,41,4],[77,6,42,4],[78,4,42,4],[78,5,43,3],[78,7,43,5],[78,9,43,7],[78,10,43,8],[79,4,45,2],[79,24,46,4],[79,28,46,4,"_reactJsxDevRuntime"],[79,47,46,4],[79,48,46,4,"jsxDEV"],[79,54,46,4],[79,56,46,5,"View"],[79,60,46,9],[79,61,46,9,"default"],[79,68,46,9],[80,6,46,10,"style"],[80,11,46,15],[80,13,46,17],[81,8,46,19,"flex"],[81,12,46,23],[81,14,46,25],[81,15,46,26],[82,8,46,28,"backgroundColor"],[82,23,46,43],[82,25,46,45],[83,6,46,55],[83,7,46,57],[84,6,46,57,"children"],[84,14,46,57],[84,30,47,6],[84,34,47,6,"_reactJsxDevRuntime"],[84,53,47,6],[84,54,47,6,"jsxDEV"],[84,60,47,6],[84,62,47,7,"FlatList"],[84,70,47,15],[84,71,47,15,"default"],[84,78,47,15],[85,8,48,8,"data"],[85,12,48,12],[85,14,48,14,"stories"],[85,21,48,22],[86,8,49,8,"renderItem"],[86,18,49,18],[86,20,49,20,"renderItem"],[86,30,49,31],[87,8,50,8,"keyExtractor"],[87,20,50,20],[87,22,50,23,"s"],[87,23,50,24],[87,27,50,29,"s"],[87,28,50,30],[87,29,50,31,"id"],[87,31,50,34],[88,8,51,8,"horizontal"],[88,18,51,18],[89,8,52,8,"pagingEnabled"],[89,21,52,21],[90,8,53,8,"showsHorizontalScrollIndicator"],[90,38,53,38],[90,40,53,40],[90,45,53,46],[91,8,54,8,"windowSize"],[91,18,54,18],[91,20,54,20],[91,21,54,22],[92,8,55,8,"initialNumToRender"],[92,26,55,26],[92,28,55,28],[92,29,55,30],[93,8,56,8,"maxToRenderPerBatch"],[93,27,56,27],[93,29,56,29],[93,30,56,31],[94,8,57,8,"updateCellsBatchingPeriod"],[94,33,57,33],[94,35,57,35],[94,37,57,38],[95,8,58,8,"removeClippedSubviews"],[95,29,58,29],[96,8,59,8,"overScrollMode"],[96,22,59,22],[96,24,59,23],[96,31,59,30],[97,8,60,8,"viewabilityConfig"],[97,25,60,25],[97,27,60,27,"viewabilityConfig"],[97,44,60,45],[98,8,61,8,"onViewableItemsChanged"],[98,30,61,30],[98,32,61,32,"onViewableItemsChanged"],[98,54,61,55],[99,8,62,8,"getItemLayout"],[99,21,62,21],[99,23,62,23,"getItemLayout"],[99,36,62,37],[100,8,63,8,"onEndReached"],[100,20,63,20],[100,22,63,22,"onEndReached"],[100,34,63,35],[101,8,64,8,"onEndReachedThreshold"],[101,29,64,29],[101,31,64,31],[102,6,64,35],[103,8,64,35,"fileName"],[103,16,64,35],[103,18,64,35,"_jsxFileName"],[103,30,64,35],[104,8,64,35,"lineNumber"],[104,18,64,35],[105,8,64,35,"columnNumber"],[105,20,64,35],[106,6,64,35],[106,13,65,7],[106,14,65,8],[106,16,67,7,"process"],[106,23,67,14],[106,24,67,15,"env"],[106,27,67,18],[106,28,67,19,"EXPO_PUBLIC_SHOW_PERF_HUD"],[106,53,67,44],[106,58,67,49],[106,61,67,52],[106,78,68,8],[106,82,68,8,"_reactJsxDevRuntime"],[106,101,68,8],[106,102,68,8,"jsxDEV"],[106,108,68,8],[106,110,68,9,"_componentsPerfHUD"],[106,128,68,16],[106,129,68,16,"PerfHUD"],[106,136,68,16],[107,8,68,17,"creators"],[107,16,68,25],[107,18,68,27],[107,19,68,29],[108,8,68,30,"stories"],[108,15,68,37],[108,17,68,39,"stories"],[108,24,68,46],[108,25,68,47,"length"],[109,6,68,54],[110,8,68,54,"fileName"],[110,16,68,54],[110,18,68,54,"_jsxFileName"],[110,30,68,54],[111,8,68,54,"lineNumber"],[111,18,68,54],[112,8,68,54,"columnNumber"],[112,20,68,54],[113,6,68,54],[113,13,68,56],[113,14,69,7],[114,4,69,7],[115,6,69,7,"fileName"],[115,14,69,7],[115,16,69,7,"_jsxFileName"],[115,28,69,7],[116,6,69,7,"lineNumber"],[116,16,69,7],[117,6,69,7,"columnNumber"],[117,18,69,7],[118,4,69,7],[118,11,70,10],[118,12,70,11],[119,2,72,0],[120,0,72,1],[120,3]],"functionMap":{"names":["<global>","StoriesScreen","useEffect$argument_0","useMemo$argument_0","useRef$argument_0","renderItem","getItemLayout","onEndReached","FlatList.props.keyExtractor"],"mappings":"AAA;eCU;YCK;GDG;oCEG,2CF;IGE;KHK;iCIG;GJE;oCKE;GLE;mCME;GNG;sBOO,WP"},"hasCjsExports":false},"type":"js/module"}]}