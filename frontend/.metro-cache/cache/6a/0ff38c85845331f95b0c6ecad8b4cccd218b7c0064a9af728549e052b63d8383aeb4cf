{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":81,"index":81}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/FlatList","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"DmaJKCBnIi5ZEPZkQdrt7FKBDEo=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/View","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"4kYBDC6LJJXoH7P9rWDi3vkLVB0=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Dimensions","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"ySrYx/xxJL+A+Ie+sLy/r/EEnF8=","exportNames":["*"],"imports":1}},{"name":"../lib/PrefetchCoordinator","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":152},"end":{"line":3,"column":65,"index":217}}],"key":"fxESIL0Vs+yHuGJWuxQHmLeHfpE=","exportNames":["*"],"imports":1}},{"name":"../components/PerfHUD","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":218},"end":{"line":4,"column":48,"index":266}}],"key":"zwBDOWOPpuFt3YJT1fYEAuvHuT0=","exportNames":["*"],"imports":1}},{"name":"../components/StoryCard","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":267},"end":{"line":5,"column":52,"index":319}}],"key":"WmPg7P1aUfwoCfSMyKym8fUbZE4=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/app/stories/StoriesScreen.tsx\",\n    _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return StoriesScreen;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _reactNativeWebDistExportsFlatList = require(_dependencyMap[2], \"react-native-web/dist/exports/FlatList\");\n  var FlatList = _interopDefault(_reactNativeWebDistExportsFlatList);\n  var _reactNativeWebDistExportsView = require(_dependencyMap[3], \"react-native-web/dist/exports/View\");\n  var View = _interopDefault(_reactNativeWebDistExportsView);\n  var _reactNativeWebDistExportsDimensions = require(_dependencyMap[4], \"react-native-web/dist/exports/Dimensions\");\n  var Dimensions = _interopDefault(_reactNativeWebDistExportsDimensions);\n  var _libPrefetchCoordinator = require(_dependencyMap[5], \"../lib/PrefetchCoordinator\");\n  var _componentsPerfHUD = require(_dependencyMap[6], \"../components/PerfHUD\");\n  var _componentsStoryCard = require(_dependencyMap[7], \"../components/StoryCard\");\n  var _reactJsxDevRuntime = require(_dependencyMap[8], \"react/jsx-dev-runtime\");\n  const {\n    width\n  } = Dimensions.default.get('window');\n  function StoriesScreen({\n    stories\n  }) {\n    _s();\n    const [visibleIndex, setVisibleIndex] = (0, _react.useState)(0);\n\n    // --- Prefetcher (3-item lookahead with video support)\n    const prefetchRef = (0, _react.useRef)(new _libPrefetchCoordinator.PrefetchCoordinator(stories, 3)).current;\n    (0, _react.useEffect)(() => {\n      prefetchRef.attachGlobal();\n      prefetchRef.updateStories(stories);\n    }, [stories]);\n\n    // --- Viewability â†’ inform prefetch focus & track visible videos\n    const viewabilityConfig = (0, _react.useMemo)(() => ({\n      itemVisiblePercentThreshold: 80\n    }), []);\n    const onViewableItemsChanged = (0, _react.useRef)(({\n      viewableItems\n    }) => {\n      const idx = viewableItems[0]?.index ?? 0;\n      setVisibleIndex(idx);\n      prefetchRef.focus(idx);\n      globalThis.__visibleIndex = idx;\n    }).current;\n    const renderItem = (0, _react.useCallback)(({\n      item,\n      index\n    }) => /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_componentsStoryCard.StoryCard, {\n      story: {\n        ...item,\n        __visible: index === visibleIndex\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 5\n    }, this), [visibleIndex]);\n    const getItemLayout = (0, _react.useCallback)((_, i) => ({\n      length: width,\n      offset: width * i,\n      index: i\n    }), []);\n    const onEndReached = (0, _react.useCallback)(() => {\n      // trigger pagination; backend already supports cursor\n      // fetchMore();\n    }, []);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(View.default, {\n      style: {\n        flex: 1,\n        backgroundColor: '#1A1A1A'\n      },\n      children: [/*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(FlatList.default, {\n        data: stories,\n        renderItem: renderItem,\n        keyExtractor: s => s.id,\n        horizontal: true,\n        pagingEnabled: true,\n        showsHorizontalScrollIndicator: false,\n        windowSize: 5,\n        initialNumToRender: 3,\n        maxToRenderPerBatch: 4,\n        updateCellsBatchingPeriod: 50,\n        removeClippedSubviews: true,\n        overScrollMode: \"never\",\n        viewabilityConfig: viewabilityConfig,\n        onViewableItemsChanged: onViewableItemsChanged,\n        getItemLayout: getItemLayout,\n        onEndReached: onEndReached,\n        onEndReachedThreshold: 0.7\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 7\n      }, this), _expoVirtualEnv.env.EXPO_PUBLIC_SHOW_PERF_HUD === \"1\" && /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_componentsPerfHUD.PerfHUD, {\n        creators: 1,\n        stories: stories.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }, this);\n  }\n  _s(StoriesScreen, \"0bJnxPG6Afj6YOaREQMnop86MIY=\");\n  _c = StoriesScreen;\n  var _c;\n  $RefreshReg$(_c, \"StoriesScreen\");\n});","lineCount":127,"map":[[14,2,11,15,"Object"],[14,8,11,15],[14,9,11,15,"defineProperty"],[14,23,11,15],[14,24,11,15,"exports"],[14,31,11,15],[15,4,11,15,"enumerable"],[15,14,11,15],[16,4,11,15,"get"],[16,7,11,15],[16,18,11,15,"get"],[16,19,11,15],[17,6,11,15],[17,13,11,15,"StoriesScreen"],[17,26,11,15],[18,4,11,15],[19,2,11,15],[20,2,72,1],[20,6,72,1,"_expoVirtualEnv"],[20,21,72,1],[20,24,72,1,"require"],[20,31,72,1],[20,32,72,1,"_dependencyMap"],[20,46,72,1],[21,2,1,0],[21,6,1,0,"_react"],[21,12,1,0],[21,15,1,0,"require"],[21,22,1,0],[21,23,1,0,"_dependencyMap"],[21,37,1,0],[22,2,1,81],[22,6,1,81,"_reactNativeWebDistExportsFlatList"],[22,40,1,81],[22,43,1,81,"require"],[22,50,1,81],[22,51,1,81,"_dependencyMap"],[22,65,1,81],[23,2,1,81],[23,6,1,81,"FlatList"],[23,14,1,81],[23,17,1,81,"_interopDefault"],[23,32,1,81],[23,33,1,81,"_reactNativeWebDistExportsFlatList"],[23,67,1,81],[24,2,1,81],[24,6,1,81,"_reactNativeWebDistExportsView"],[24,36,1,81],[24,39,1,81,"require"],[24,46,1,81],[24,47,1,81,"_dependencyMap"],[24,61,1,81],[25,2,1,81],[25,6,1,81,"View"],[25,10,1,81],[25,13,1,81,"_interopDefault"],[25,28,1,81],[25,29,1,81,"_reactNativeWebDistExportsView"],[25,59,1,81],[26,2,1,81],[26,6,1,81,"_reactNativeWebDistExportsDimensions"],[26,42,1,81],[26,45,1,81,"require"],[26,52,1,81],[26,53,1,81,"_dependencyMap"],[26,67,1,81],[27,2,1,81],[27,6,1,81,"Dimensions"],[27,16,1,81],[27,19,1,81,"_interopDefault"],[27,34,1,81],[27,35,1,81,"_reactNativeWebDistExportsDimensions"],[27,71,1,81],[28,2,3,0],[28,6,3,0,"_libPrefetchCoordinator"],[28,29,3,0],[28,32,3,0,"require"],[28,39,3,0],[28,40,3,0,"_dependencyMap"],[28,54,3,0],[29,2,4,0],[29,6,4,0,"_componentsPerfHUD"],[29,24,4,0],[29,27,4,0,"require"],[29,34,4,0],[29,35,4,0,"_dependencyMap"],[29,49,4,0],[30,2,5,0],[30,6,5,0,"_componentsStoryCard"],[30,26,5,0],[30,29,5,0,"require"],[30,36,5,0],[30,37,5,0,"_dependencyMap"],[30,51,5,0],[31,2,5,52],[31,6,5,52,"_reactJsxDevRuntime"],[31,25,5,52],[31,28,5,52,"require"],[31,35,5,52],[31,36,5,52,"_dependencyMap"],[31,50,5,52],[32,2,7,0],[32,8,7,6],[33,4,7,8,"width"],[34,2,7,14],[34,3,7,15],[34,6,7,18,"Dimensions"],[34,16,7,28],[34,17,7,28,"default"],[34,24,7,28],[34,25,7,29,"get"],[34,28,7,32],[34,29,7,33],[34,37,7,41],[34,38,7,42],[35,2,11,15],[35,11,11,24,"StoriesScreen"],[35,24,11,37,"StoriesScreen"],[35,25,11,38],[36,4,11,40,"stories"],[37,2,11,70],[37,3,11,71],[37,5,11,73],[38,4,11,73,"_s"],[38,6,11,73],[39,4,12,2],[39,10,12,8],[39,11,12,9,"visibleIndex"],[39,23,12,21],[39,25,12,23,"setVisibleIndex"],[39,40,12,38],[39,41,12,39],[39,44,12,42],[39,48,12,42,"useState"],[39,54,12,50],[39,55,12,50,"useState"],[39,63,12,50],[39,65,12,51],[39,66,12,52],[39,67,12,53],[41,4,14,2],[42,4,15,2],[42,10,15,8,"prefetchRef"],[42,21,15,19],[42,24,15,22],[42,28,15,22,"useRef"],[42,34,15,28],[42,35,15,28,"useRef"],[42,41,15,28],[42,43,15,29],[42,47,15,33,"PrefetchCoordinator"],[42,70,15,52],[42,71,15,52,"PrefetchCoordinator"],[42,90,15,52],[42,91,15,53,"stories"],[42,98,15,60],[42,100,15,62],[42,101,15,63],[42,102,15,64],[42,103,15,65],[42,104,15,66,"current"],[42,111,15,73],[43,4,16,2],[43,8,16,2,"useEffect"],[43,14,16,11],[43,15,16,11,"useEffect"],[43,24,16,11],[43,26,16,12],[43,32,16,18],[44,6,17,4,"prefetchRef"],[44,17,17,15],[44,18,17,16,"attachGlobal"],[44,30,17,28],[44,31,17,29],[44,32,17,30],[45,6,18,4,"prefetchRef"],[45,17,18,15],[45,18,18,16,"updateStories"],[45,31,18,29],[45,32,18,30,"stories"],[45,39,18,37],[45,40,18,38],[46,4,19,2],[46,5,19,3],[46,7,19,5],[46,8,19,6,"stories"],[46,15,19,13],[46,16,19,14],[46,17,19,15],[48,4,21,2],[49,4,22,2],[49,10,22,8,"viewabilityConfig"],[49,27,22,25],[49,30,22,28],[49,34,22,28,"useMemo"],[49,40,22,35],[49,41,22,35,"useMemo"],[49,48,22,35],[49,50,22,36],[49,57,22,43],[50,6,22,45,"itemVisiblePercentThreshold"],[50,33,22,72],[50,35,22,74],[51,4,22,77],[51,5,22,78],[51,6,22,79],[51,8,22,81],[51,10,22,83],[51,11,22,84],[52,4,23,2],[52,10,23,8,"onViewableItemsChanged"],[52,32,23,30],[52,35,23,33],[52,39,23,33,"useRef"],[52,45,23,39],[52,46,23,39,"useRef"],[52,52,23,39],[52,54,24,4],[52,55,24,5],[53,6,24,7,"viewableItems"],[54,4,24,53],[54,5,24,54],[54,10,24,59],[55,6,25,6],[55,12,25,12,"idx"],[55,15,25,15],[55,18,25,18,"viewableItems"],[55,31,25,31],[55,32,25,32],[55,33,25,33],[55,34,25,34],[55,36,25,36,"index"],[55,41,25,41],[55,45,25,45],[55,46,25,46],[56,6,26,6,"setVisibleIndex"],[56,21,26,21],[56,22,26,22,"idx"],[56,25,26,25],[56,26,26,26],[57,6,27,6,"prefetchRef"],[57,17,27,17],[57,18,27,18,"focus"],[57,23,27,23],[57,24,27,24,"idx"],[57,27,27,27],[57,28,27,28],[58,6,28,7,"globalThis"],[58,16,28,17],[58,17,28,26,"__visibleIndex"],[58,31,28,40],[58,34,28,43,"idx"],[58,37,28,46],[59,4,29,4],[59,5,30,2],[59,6,30,3],[59,7,30,4,"current"],[59,14,30,11],[60,4,32,2],[60,10,32,8,"renderItem"],[60,20,32,18],[60,23,32,21],[60,27,32,21,"useCallback"],[60,33,32,32],[60,34,32,32,"useCallback"],[60,45,32,32],[60,47,32,33],[60,48,32,34],[61,6,32,36,"item"],[61,10,32,40],[62,6,32,42,"index"],[63,4,32,80],[63,5,32,81],[63,23,33,4],[63,27,33,4,"_reactJsxDevRuntime"],[63,46,33,4],[63,47,33,4,"jsxDEV"],[63,53,33,4],[63,55,33,5,"_componentsStoryCard"],[63,75,33,14],[63,76,33,14,"StoryCard"],[63,85,33,14],[64,6,33,15,"story"],[64,11,33,20],[64,13,33,22],[65,8,33,24],[65,11,33,27,"item"],[65,15,33,31],[66,8,33,33,"__visible"],[66,17,33,42],[66,19,33,44,"index"],[66,24,33,49],[66,29,33,54,"visibleIndex"],[67,6,33,67],[68,4,33,69],[69,6,33,69,"fileName"],[69,14,33,69],[69,16,33,69,"_jsxFileName"],[69,28,33,69],[70,6,33,69,"lineNumber"],[70,16,33,69],[71,6,33,69,"columnNumber"],[71,18,33,69],[72,4,33,69],[72,11,33,71],[72,12,34,3],[72,14,34,5],[72,15,34,6,"visibleIndex"],[72,27,34,18],[72,28,34,19],[72,29,34,20],[73,4,36,2],[73,10,36,8,"getItemLayout"],[73,23,36,21],[73,26,36,24],[73,30,36,24,"useCallback"],[73,36,36,35],[73,37,36,35,"useCallback"],[73,48,36,35],[73,50,36,36],[73,51,36,37,"_"],[73,52,36,43],[73,54,36,45,"i"],[73,55,36,54],[73,61,37,4],[74,6,37,6,"length"],[74,12,37,12],[74,14,37,14,"width"],[74,19,37,19],[75,6,37,21,"offset"],[75,12,37,27],[75,14,37,29,"width"],[75,19,37,34],[75,22,37,37,"i"],[75,23,37,38],[76,6,37,40,"index"],[76,11,37,45],[76,13,37,47,"i"],[77,4,37,49],[77,5,37,50],[77,6,38,3],[77,8,38,5],[77,10,38,7],[77,11,38,8],[78,4,40,2],[78,10,40,8,"onEndReached"],[78,22,40,20],[78,25,40,23],[78,29,40,23,"useCallback"],[78,35,40,34],[78,36,40,34,"useCallback"],[78,47,40,34],[78,49,40,35],[78,55,40,41],[79,6,41,4],[80,6,42,4],[81,4,42,4],[81,5,43,3],[81,7,43,5],[81,9,43,7],[81,10,43,8],[82,4,45,2],[82,24,46,4],[82,28,46,4,"_reactJsxDevRuntime"],[82,47,46,4],[82,48,46,4,"jsxDEV"],[82,54,46,4],[82,56,46,5,"View"],[82,60,46,9],[82,61,46,9,"default"],[82,68,46,9],[83,6,46,10,"style"],[83,11,46,15],[83,13,46,17],[84,8,46,19,"flex"],[84,12,46,23],[84,14,46,25],[84,15,46,26],[85,8,46,28,"backgroundColor"],[85,23,46,43],[85,25,46,45],[86,6,46,55],[86,7,46,57],[87,6,46,57,"children"],[87,14,46,57],[87,30,47,6],[87,34,47,6,"_reactJsxDevRuntime"],[87,53,47,6],[87,54,47,6,"jsxDEV"],[87,60,47,6],[87,62,47,7,"FlatList"],[87,70,47,15],[87,71,47,15,"default"],[87,78,47,15],[88,8,48,8,"data"],[88,12,48,12],[88,14,48,14,"stories"],[88,21,48,22],[89,8,49,8,"renderItem"],[89,18,49,18],[89,20,49,20,"renderItem"],[89,30,49,31],[90,8,50,8,"keyExtractor"],[90,20,50,20],[90,22,50,23,"s"],[90,23,50,24],[90,27,50,29,"s"],[90,28,50,30],[90,29,50,31,"id"],[90,31,50,34],[91,8,51,8,"horizontal"],[91,18,51,18],[92,8,52,8,"pagingEnabled"],[92,21,52,21],[93,8,53,8,"showsHorizontalScrollIndicator"],[93,38,53,38],[93,40,53,40],[93,45,53,46],[94,8,54,8,"windowSize"],[94,18,54,18],[94,20,54,20],[94,21,54,22],[95,8,55,8,"initialNumToRender"],[95,26,55,26],[95,28,55,28],[95,29,55,30],[96,8,56,8,"maxToRenderPerBatch"],[96,27,56,27],[96,29,56,29],[96,30,56,31],[97,8,57,8,"updateCellsBatchingPeriod"],[97,33,57,33],[97,35,57,35],[97,37,57,38],[98,8,58,8,"removeClippedSubviews"],[98,29,58,29],[99,8,59,8,"overScrollMode"],[99,22,59,22],[99,24,59,23],[99,31,59,30],[100,8,60,8,"viewabilityConfig"],[100,25,60,25],[100,27,60,27,"viewabilityConfig"],[100,44,60,45],[101,8,61,8,"onViewableItemsChanged"],[101,30,61,30],[101,32,61,32,"onViewableItemsChanged"],[101,54,61,55],[102,8,62,8,"getItemLayout"],[102,21,62,21],[102,23,62,23,"getItemLayout"],[102,36,62,37],[103,8,63,8,"onEndReached"],[103,20,63,20],[103,22,63,22,"onEndReached"],[103,34,63,35],[104,8,64,8,"onEndReachedThreshold"],[104,29,64,29],[104,31,64,31],[105,6,64,35],[106,8,64,35,"fileName"],[106,16,64,35],[106,18,64,35,"_jsxFileName"],[106,30,64,35],[107,8,64,35,"lineNumber"],[107,18,64,35],[108,8,64,35,"columnNumber"],[108,20,64,35],[109,6,64,35],[109,13,65,7],[109,14,65,8],[109,16,67,7,"_expoVirtualEnv"],[109,31,67,7],[109,32,67,7,"env"],[109,35,67,7],[109,36,67,7,"EXPO_PUBLIC_SHOW_PERF_HUD"],[109,61,67,7],[109,66,67,49],[109,69,67,52],[109,86,68,8],[109,90,68,8,"_reactJsxDevRuntime"],[109,109,68,8],[109,110,68,8,"jsxDEV"],[109,116,68,8],[109,118,68,9,"_componentsPerfHUD"],[109,136,68,16],[109,137,68,16,"PerfHUD"],[109,144,68,16],[110,8,68,17,"creators"],[110,16,68,25],[110,18,68,27],[110,19,68,29],[111,8,68,30,"stories"],[111,15,68,37],[111,17,68,39,"stories"],[111,24,68,46],[111,25,68,47,"length"],[112,6,68,54],[113,8,68,54,"fileName"],[113,16,68,54],[113,18,68,54,"_jsxFileName"],[113,30,68,54],[114,8,68,54,"lineNumber"],[114,18,68,54],[115,8,68,54,"columnNumber"],[115,20,68,54],[116,6,68,54],[116,13,68,56],[116,14,69,7],[117,4,69,7],[118,6,69,7,"fileName"],[118,14,69,7],[118,16,69,7,"_jsxFileName"],[118,28,69,7],[119,6,69,7,"lineNumber"],[119,16,69,7],[120,6,69,7,"columnNumber"],[120,18,69,7],[121,4,69,7],[121,11,70,10],[121,12,70,11],[122,2,72,0],[123,2,72,1,"_s"],[123,4,72,1],[123,5,11,24,"StoriesScreen"],[123,18,11,37],[124,2,11,37,"_c"],[124,4,11,37],[124,7,11,24,"StoriesScreen"],[124,20,11,37],[125,2,11,37],[125,6,11,37,"_c"],[125,8,11,37],[126,2,11,37,"$RefreshReg$"],[126,14,11,37],[126,15,11,37,"_c"],[126,17,11,37],[127,0,11,37],[127,3]],"functionMap":{"names":["<global>","StoriesScreen","useEffect$argument_0","useMemo$argument_0","useRef$argument_0","renderItem","getItemLayout","onEndReached","FlatList.props.keyExtractor"],"mappings":"AAA;eCU;YCK;GDG;oCEG,2CF;IGE;KHK;iCIG;GJE;oCKE;GLE;mCME;GNG;sBOO,WP"},"hasCjsExports":false},"type":"js/module"}]}