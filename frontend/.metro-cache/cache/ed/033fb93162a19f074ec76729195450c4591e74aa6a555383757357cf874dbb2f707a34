{"dependencies":[{"name":"expo-asset","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":35,"index":35}}],"key":"ZXJFWHziJpBZf3W7vl00wXf6fd8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"PreloadCoordinator\", {\n    enumerable: true,\n    get: function () {\n      return PreloadCoordinator;\n    }\n  });\n  var _expoAsset = require(_dependencyMap[0], \"expo-asset\");\n  class PreloadCoordinator {\n    constructor(cache) {\n      this.cache = cache;\n    }\n    async preloadStory(story) {\n      if (!story?.mediaUrl) return;\n      if (this.cache.get(story.mediaUrl)) return; // already cached\n      try {\n        const asset = _expoAsset.Asset.fromURI(story.mediaUrl);\n        await asset.downloadAsync();\n        const bytes = asset.downloaded ? asset.filesize ?? 1_000_000 : 1_000_000;\n        this.cache.set(story.mediaUrl, asset.localUri ?? story.mediaUrl, bytes);\n      } catch {\n        // ignore preload failures\n      }\n    }\n    async preloadNext(currentIndex, stories, nextCreatorFirst) {\n      const next = stories[currentIndex + 1];\n      if (next) await this.preloadStory(next);\n      if (nextCreatorFirst) await this.preloadStory(nextCreatorFirst);\n    }\n  }\n});","lineCount":36,"map":[[7,2,5,0,"Object"],[7,8,5,0],[7,9,5,0,"defineProperty"],[7,23,5,0],[7,24,5,0,"exports"],[7,31,5,0],[8,4,5,0,"enumerable"],[8,14,5,0],[9,4,5,0,"get"],[9,7,5,0],[9,18,5,0,"get"],[9,19,5,0],[10,6,5,0],[10,13,5,0,"PreloadCoordinator"],[10,31,5,0],[11,4,5,0],[12,2,5,0],[13,2,1,0],[13,6,1,0,"_expoAsset"],[13,16,1,0],[13,19,1,0,"require"],[13,26,1,0],[13,27,1,0,"_dependencyMap"],[13,41,1,0],[14,2,5,7],[14,8,5,13,"PreloadCoordinator"],[14,26,5,31],[14,27,5,32],[15,4,7,2,"constructor"],[15,15,7,13,"constructor"],[15,16,7,14,"cache"],[15,21,7,34],[15,23,7,36],[16,6,7,38],[16,10,7,42],[16,11,7,43,"cache"],[16,16,7,48],[16,19,7,51,"cache"],[16,24,7,56],[17,4,7,58],[18,4,9,2],[18,10,9,8,"preloadStory"],[18,22,9,20,"preloadStory"],[18,23,9,21,"story"],[18,28,9,33],[18,30,9,35],[19,6,10,4],[19,10,10,8],[19,11,10,9,"story"],[19,16,10,14],[19,18,10,16,"mediaUrl"],[19,26,10,24],[19,28,10,26],[20,6,11,4],[20,10,11,8],[20,14,11,12],[20,15,11,13,"cache"],[20,20,11,18],[20,21,11,19,"get"],[20,24,11,22],[20,25,11,23,"story"],[20,30,11,28],[20,31,11,29,"mediaUrl"],[20,39,11,37],[20,40,11,38],[20,42,11,40],[20,49,11,47],[20,50,11,48],[21,6,12,4],[21,10,12,8],[22,8,13,6],[22,14,13,12,"asset"],[22,19,13,17],[22,22,13,20,"Asset"],[22,32,13,25],[22,33,13,25,"Asset"],[22,38,13,25],[22,39,13,26,"fromURI"],[22,46,13,33],[22,47,13,34,"story"],[22,52,13,39],[22,53,13,40,"mediaUrl"],[22,61,13,48],[22,62,13,49],[23,8,14,6],[23,14,14,12,"asset"],[23,19,14,17],[23,20,14,18,"downloadAsync"],[23,33,14,31],[23,34,14,32],[23,35,14,33],[24,8,15,6],[24,14,15,12,"bytes"],[24,19,15,17],[24,22,15,21,"asset"],[24,27,15,26],[24,28,15,35,"downloaded"],[24,38,15,45],[24,41,15,49,"asset"],[24,46,15,54],[24,47,15,63,"filesize"],[24,55,15,71],[24,59,15,75],[24,68,15,84],[24,71,15,87],[24,80,15,96],[25,8,16,6],[25,12,16,10],[25,13,16,11,"cache"],[25,18,16,16],[25,19,16,17,"set"],[25,22,16,20],[25,23,16,21,"story"],[25,28,16,26],[25,29,16,27,"mediaUrl"],[25,37,16,35],[25,39,16,37,"asset"],[25,44,16,42],[25,45,16,43,"localUri"],[25,53,16,51],[25,57,16,55,"story"],[25,62,16,60],[25,63,16,61,"mediaUrl"],[25,71,16,69],[25,73,16,71,"bytes"],[25,78,16,76],[25,79,16,77],[26,6,17,4],[26,7,17,5],[26,8,17,6],[26,14,17,12],[27,8,18,6],[28,6,18,6],[29,4,20,2],[30,4,22,2],[30,10,22,8,"preloadNext"],[30,21,22,19,"preloadNext"],[30,22,22,20,"currentIndex"],[30,34,22,40],[30,36,22,42,"stories"],[30,43,22,58],[30,45,22,60,"nextCreatorFirst"],[30,61,22,84],[30,63,22,86],[31,6,23,4],[31,12,23,10,"next"],[31,16,23,14],[31,19,23,17,"stories"],[31,26,23,24],[31,27,23,25,"currentIndex"],[31,39,23,37],[31,42,23,40],[31,43,23,41],[31,44,23,42],[32,6,24,4],[32,10,24,8,"next"],[32,14,24,12],[32,16,24,14],[32,22,24,20],[32,26,24,24],[32,27,24,25,"preloadStory"],[32,39,24,37],[32,40,24,38,"next"],[32,44,24,42],[32,45,24,43],[33,6,25,4],[33,10,25,8,"nextCreatorFirst"],[33,26,25,24],[33,28,25,26],[33,34,25,32],[33,38,25,36],[33,39,25,37,"preloadStory"],[33,51,25,49],[33,52,25,50,"nextCreatorFirst"],[33,68,25,66],[33,69,25,67],[34,4,26,2],[35,2,27,0],[36,0,27,1],[36,3]],"functionMap":{"names":["<global>","PreloadCoordinator","constructor","preloadStory","preloadNext"],"mappings":"AAA;OCI;ECE,yDD;EEE;GFW;EGE;GHI"},"hasCjsExports":false},"type":"js/module"}]}