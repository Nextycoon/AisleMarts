{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":117},"end":{"line":5,"column":36,"index":153}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":154},"end":{"line":6,"column":39,"index":193}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  /**\n   * Phase 3 Commerce Tracking Hook\n   * Tracks story impressions, CTAs, and purchases for affiliate attribution\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useCommerceEvents = useCommerceEvents;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _expoConstants = require(_dependencyMap[2], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  function useCommerceEvents(userId) {\n    _s();\n    const getBaseUrl = () => {\n      return Constants.default.expoConfig?.extra?.backendUrl || _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n    };\n    const trackImpression = (0, _react.useCallback)(async (storyId, userIdOverride) => {\n      try {\n        const response = await fetch(`${getBaseUrl()}/api/track/impression`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            storyId,\n            userId: userIdOverride || userId\n          })\n        });\n        if (!response.ok) {\n          console.warn('Failed to track impression:', response.status);\n        } else {\n          console.log(`✅ Impression tracked: ${storyId}`);\n        }\n      } catch (error) {\n        console.error('Error tracking impression:', error);\n      }\n    }, [userId]);\n    const trackCTA = (0, _react.useCallback)(async (storyId, productId, userIdOverride) => {\n      try {\n        const response = await fetch(`${getBaseUrl()}/api/track/cta`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            storyId,\n            productId,\n            userId: userIdOverride || userId\n          })\n        });\n        if (!response.ok) {\n          console.warn('Failed to track CTA:', response.status);\n        } else {\n          console.log(`✅ CTA tracked: ${storyId} -> ${productId}`);\n        }\n      } catch (error) {\n        console.error('Error tracking CTA:', error);\n      }\n    }, [userId]);\n    const trackPurchase = (0, _react.useCallback)(async (orderId, productId, amount, currency, referrerStoryId, userIdOverride) => {\n      try {\n        const response = await fetch(`${getBaseUrl()}/api/track/purchase`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            orderId,\n            userId: userIdOverride || userId,\n            productId,\n            amount,\n            currency,\n            referrerStoryId\n          })\n        });\n        if (!response.ok) {\n          console.warn('Failed to track purchase:', response.status);\n          return {\n            ok: false\n          };\n        }\n        const result = await response.json();\n        console.log(`✅ Purchase tracked: ${orderId} -> Commission: $${result.commission} to creator: ${result.creatorId}`);\n        return result;\n      } catch (error) {\n        console.error('Error tracking purchase:', error);\n        return {\n          ok: false\n        };\n      }\n    }, [userId]);\n    return {\n      trackImpression,\n      trackCTA,\n      trackPurchase\n    };\n  }\n  _s(useCommerceEvents, \"gRxmmxeOmNuuxlDo1MaLrqqY+G8=\");\n});","lineCount":109,"map":[[5,2,1,0],[6,0,2,0],[7,0,3,0],[8,0,4,0],[9,2,1,0,"Object"],[9,8,1,0],[9,9,1,0,"defineProperty"],[9,23,1,0],[9,24,1,0,"exports"],[9,31,1,0],[10,4,1,0,"value"],[10,9,1,0],[11,2,1,0],[12,2,1,0],[12,11,1,0,"_interopDefault"],[12,27,1,0,"e"],[12,28,1,0],[13,4,1,0],[13,11,1,0,"e"],[13,12,1,0],[13,16,1,0,"e"],[13,17,1,0],[13,18,1,0,"__esModule"],[13,28,1,0],[13,31,1,0,"e"],[13,32,1,0],[14,6,1,0,"default"],[14,13,1,0],[14,15,1,0,"e"],[15,4,1,0],[16,2,1,0],[17,2,21,0,"exports"],[17,9,21,0],[17,10,21,0,"useCommerceEvents"],[17,27,21,0],[17,30,21,0,"useCommerceEvents"],[17,47,21,0],[18,2,116,1],[18,6,116,1,"_expoVirtualEnv"],[18,21,116,1],[18,24,116,1,"require"],[18,31,116,1],[18,32,116,1,"_dependencyMap"],[18,46,116,1],[19,2,5,0],[19,6,5,0,"_react"],[19,12,5,0],[19,15,5,0,"require"],[19,22,5,0],[19,23,5,0,"_dependencyMap"],[19,37,5,0],[20,2,6,0],[20,6,6,0,"_expoConstants"],[20,20,6,0],[20,23,6,0,"require"],[20,30,6,0],[20,31,6,0,"_dependencyMap"],[20,45,6,0],[21,2,6,0],[21,6,6,0,"Constants"],[21,15,6,0],[21,18,6,0,"_interopDefault"],[21,33,6,0],[21,34,6,0,"_expoConstants"],[21,48,6,0],[22,2,21,7],[22,11,21,16,"useCommerceEvents"],[22,28,21,33,"useCommerceEvents"],[22,29,21,34,"userId"],[22,35,21,49],[22,37,21,70],[23,4,21,70,"_s"],[23,6,21,70],[24,4,22,2],[24,10,22,8,"getBaseUrl"],[24,20,22,18],[24,23,22,21,"getBaseUrl"],[24,24,22,21],[24,29,22,27],[25,6,23,4],[25,13,23,11,"Constants"],[25,22,23,20],[25,23,23,20,"default"],[25,30,23,20],[25,31,23,21,"expoConfig"],[25,41,23,31],[25,43,23,33,"extra"],[25,48,23,38],[25,50,23,40,"backendUrl"],[25,60,23,50],[25,64,23,50,"_expoVirtualEnv"],[25,79,23,50],[25,80,23,50,"env"],[25,83,23,50],[25,84,23,50,"EXPO_PUBLIC_BACKEND_URL"],[25,107,23,89],[25,111,23,93],[25,134,23,116],[26,4,24,2],[26,5,24,3],[27,4,26,2],[27,10,26,8,"trackImpression"],[27,25,26,23],[27,28,26,26],[27,32,26,26,"useCallback"],[27,38,26,37],[27,39,26,37,"useCallback"],[27,50,26,37],[27,52,26,38],[27,59,26,45,"storyId"],[27,66,26,60],[27,68,26,62,"userIdOverride"],[27,82,26,85],[27,87,26,90],[28,6,27,4],[28,10,27,8],[29,8,28,6],[29,14,28,12,"response"],[29,22,28,20],[29,25,28,23],[29,31,28,29,"fetch"],[29,36,28,34],[29,37,28,35],[29,40,28,38,"getBaseUrl"],[29,50,28,48],[29,51,28,49],[29,52,28,50],[29,75,28,73],[29,77,28,75],[30,10,29,8,"method"],[30,16,29,14],[30,18,29,16],[30,24,29,22],[31,10,30,8,"headers"],[31,17,30,15],[31,19,30,17],[32,12,31,10],[32,26,31,24],[32,28,31,26],[33,10,32,8],[33,11,32,9],[34,10,33,8,"body"],[34,14,33,12],[34,16,33,14,"JSON"],[34,20,33,18],[34,21,33,19,"stringify"],[34,30,33,28],[34,31,33,29],[35,12,34,10,"storyId"],[35,19,34,17],[36,12,35,10,"userId"],[36,18,35,16],[36,20,35,18,"userIdOverride"],[36,34,35,32],[36,38,35,36,"userId"],[37,10,36,8],[37,11,36,9],[38,8,37,6],[38,9,37,7],[38,10,37,8],[39,8,39,6],[39,12,39,10],[39,13,39,11,"response"],[39,21,39,19],[39,22,39,20,"ok"],[39,24,39,22],[39,26,39,24],[40,10,40,8,"console"],[40,17,40,15],[40,18,40,16,"warn"],[40,22,40,20],[40,23,40,21],[40,52,40,50],[40,54,40,52,"response"],[40,62,40,60],[40,63,40,61,"status"],[40,69,40,67],[40,70,40,68],[41,8,41,6],[41,9,41,7],[41,15,41,13],[42,10,42,8,"console"],[42,17,42,15],[42,18,42,16,"log"],[42,21,42,19],[42,22,42,20],[42,47,42,45,"storyId"],[42,54,42,52],[42,56,42,54],[42,57,42,55],[43,8,43,6],[44,6,44,4],[44,7,44,5],[44,8,44,6],[44,15,44,13,"error"],[44,20,44,18],[44,22,44,20],[45,8,45,6,"console"],[45,15,45,13],[45,16,45,14,"error"],[45,21,45,19],[45,22,45,20],[45,50,45,48],[45,52,45,50,"error"],[45,57,45,55],[45,58,45,56],[46,6,46,4],[47,4,47,2],[47,5,47,3],[47,7,47,5],[47,8,47,6,"userId"],[47,14,47,12],[47,15,47,13],[47,16,47,14],[48,4,49,2],[48,10,49,8,"trackCTA"],[48,18,49,16],[48,21,49,19],[48,25,49,19,"useCallback"],[48,31,49,30],[48,32,49,30,"useCallback"],[48,43,49,30],[48,45,49,31],[48,52,49,38,"storyId"],[48,59,49,53],[48,61,49,55,"productId"],[48,70,49,73],[48,72,49,75,"userIdOverride"],[48,86,49,98],[48,91,49,103],[49,6,50,4],[49,10,50,8],[50,8,51,6],[50,14,51,12,"response"],[50,22,51,20],[50,25,51,23],[50,31,51,29,"fetch"],[50,36,51,34],[50,37,51,35],[50,40,51,38,"getBaseUrl"],[50,50,51,48],[50,51,51,49],[50,52,51,50],[50,68,51,66],[50,70,51,68],[51,10,52,8,"method"],[51,16,52,14],[51,18,52,16],[51,24,52,22],[52,10,53,8,"headers"],[52,17,53,15],[52,19,53,17],[53,12,54,10],[53,26,54,24],[53,28,54,26],[54,10,55,8],[54,11,55,9],[55,10,56,8,"body"],[55,14,56,12],[55,16,56,14,"JSON"],[55,20,56,18],[55,21,56,19,"stringify"],[55,30,56,28],[55,31,56,29],[56,12,57,10,"storyId"],[56,19,57,17],[57,12,58,10,"productId"],[57,21,58,19],[58,12,59,10,"userId"],[58,18,59,16],[58,20,59,18,"userIdOverride"],[58,34,59,32],[58,38,59,36,"userId"],[59,10,60,8],[59,11,60,9],[60,8,61,6],[60,9,61,7],[60,10,61,8],[61,8,63,6],[61,12,63,10],[61,13,63,11,"response"],[61,21,63,19],[61,22,63,20,"ok"],[61,24,63,22],[61,26,63,24],[62,10,64,8,"console"],[62,17,64,15],[62,18,64,16,"warn"],[62,22,64,20],[62,23,64,21],[62,45,64,43],[62,47,64,45,"response"],[62,55,64,53],[62,56,64,54,"status"],[62,62,64,60],[62,63,64,61],[63,8,65,6],[63,9,65,7],[63,15,65,13],[64,10,66,8,"console"],[64,17,66,15],[64,18,66,16,"log"],[64,21,66,19],[64,22,66,20],[64,40,66,38,"storyId"],[64,47,66,45],[64,54,66,52,"productId"],[64,63,66,61],[64,65,66,63],[64,66,66,64],[65,8,67,6],[66,6,68,4],[66,7,68,5],[66,8,68,6],[66,15,68,13,"error"],[66,20,68,18],[66,22,68,20],[67,8,69,6,"console"],[67,15,69,13],[67,16,69,14,"error"],[67,21,69,19],[67,22,69,20],[67,43,69,41],[67,45,69,43,"error"],[67,50,69,48],[67,51,69,49],[68,6,70,4],[69,4,71,2],[69,5,71,3],[69,7,71,5],[69,8,71,6,"userId"],[69,14,71,12],[69,15,71,13],[69,16,71,14],[70,4,73,2],[70,10,73,8,"trackPurchase"],[70,23,73,21],[70,26,73,24],[70,30,73,24,"useCallback"],[70,36,73,35],[70,37,73,35,"useCallback"],[70,48,73,35],[70,50,73,36],[70,57,74,4,"orderId"],[70,64,74,19],[70,66,75,4,"productId"],[70,75,75,21],[70,77,76,4,"amount"],[70,83,76,18],[70,85,77,4,"currency"],[70,93,77,20],[70,95,78,4,"referrerStoryId"],[70,110,78,28],[70,112,79,4,"userIdOverride"],[70,126,79,27],[70,131,80,7],[71,6,81,4],[71,10,81,8],[72,8,82,6],[72,14,82,12,"response"],[72,22,82,20],[72,25,82,23],[72,31,82,29,"fetch"],[72,36,82,34],[72,37,82,35],[72,40,82,38,"getBaseUrl"],[72,50,82,48],[72,51,82,49],[72,52,82,50],[72,73,82,71],[72,75,82,73],[73,10,83,8,"method"],[73,16,83,14],[73,18,83,16],[73,24,83,22],[74,10,84,8,"headers"],[74,17,84,15],[74,19,84,17],[75,12,85,10],[75,26,85,24],[75,28,85,26],[76,10,86,8],[76,11,86,9],[77,10,87,8,"body"],[77,14,87,12],[77,16,87,14,"JSON"],[77,20,87,18],[77,21,87,19,"stringify"],[77,30,87,28],[77,31,87,29],[78,12,88,10,"orderId"],[78,19,88,17],[79,12,89,10,"userId"],[79,18,89,16],[79,20,89,18,"userIdOverride"],[79,34,89,32],[79,38,89,36,"userId"],[79,44,89,42],[80,12,90,10,"productId"],[80,21,90,19],[81,12,91,10,"amount"],[81,18,91,16],[82,12,92,10,"currency"],[82,20,92,18],[83,12,93,10,"referrerStoryId"],[84,10,94,8],[84,11,94,9],[85,8,95,6],[85,9,95,7],[85,10,95,8],[86,8,97,6],[86,12,97,10],[86,13,97,11,"response"],[86,21,97,19],[86,22,97,20,"ok"],[86,24,97,22],[86,26,97,24],[87,10,98,8,"console"],[87,17,98,15],[87,18,98,16,"warn"],[87,22,98,20],[87,23,98,21],[87,50,98,48],[87,52,98,50,"response"],[87,60,98,58],[87,61,98,59,"status"],[87,67,98,65],[87,68,98,66],[88,10,99,8],[88,17,99,15],[89,12,99,17,"ok"],[89,14,99,19],[89,16,99,21],[90,10,99,27],[90,11,99,28],[91,8,100,6],[92,8,102,6],[92,14,102,12,"result"],[92,20,102,18],[92,23,102,21],[92,29,102,27,"response"],[92,37,102,35],[92,38,102,36,"json"],[92,42,102,40],[92,43,102,41],[92,44,102,42],[93,8,103,6,"console"],[93,15,103,13],[93,16,103,14,"log"],[93,19,103,17],[93,20,103,18],[93,43,103,41,"orderId"],[93,50,103,48],[93,70,103,68,"result"],[93,76,103,74],[93,77,103,75,"commission"],[93,87,103,85],[93,103,103,101,"result"],[93,109,103,107],[93,110,103,108,"creatorId"],[93,119,103,117],[93,121,103,119],[93,122,103,120],[94,8,104,6],[94,15,104,13,"result"],[94,21,104,19],[95,6,105,4],[95,7,105,5],[95,8,105,6],[95,15,105,13,"error"],[95,20,105,18],[95,22,105,20],[96,8,106,6,"console"],[96,15,106,13],[96,16,106,14,"error"],[96,21,106,19],[96,22,106,20],[96,48,106,46],[96,50,106,48,"error"],[96,55,106,53],[96,56,106,54],[97,8,107,6],[97,15,107,13],[98,10,107,15,"ok"],[98,12,107,17],[98,14,107,19],[99,8,107,25],[99,9,107,26],[100,6,108,4],[101,4,109,2],[101,5,109,3],[101,7,109,5],[101,8,109,6,"userId"],[101,14,109,12],[101,15,109,13],[101,16,109,14],[102,4,111,2],[102,11,111,9],[103,6,112,4,"trackImpression"],[103,21,112,19],[104,6,113,4,"trackCTA"],[104,14,113,12],[105,6,114,4,"trackPurchase"],[106,4,115,2],[106,5,115,3],[107,2,116,0],[108,2,116,1,"_s"],[108,4,116,1],[108,5,21,16,"useCommerceEvents"],[108,22,21,33],[109,0,21,33],[109,3]],"functionMap":{"names":["<global>","useCommerceEvents","getBaseUrl","trackImpression","trackCTA","trackPurchase"],"mappings":"AAA;OCoB;qBCC;GDE;sCEE;GFqB;+BGE;GHsB;oCIE;GJoC"},"hasCjsExports":false},"type":"js/module"}]}