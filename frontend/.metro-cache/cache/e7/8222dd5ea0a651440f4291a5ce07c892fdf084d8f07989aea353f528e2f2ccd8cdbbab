{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"MediaCacheLRU\", {\n    enumerable: true,\n    get: function () {\n      return MediaCacheLRU;\n    }\n  });\n  var _babelRuntimeHelpersClassCallCheck = require(_dependencyMap[0], \"@babel/runtime/helpers/classCallCheck\");\n  var _classCallCheck = _interopDefault(_babelRuntimeHelpersClassCallCheck);\n  var _babelRuntimeHelpersCreateClass = require(_dependencyMap[1], \"@babel/runtime/helpers/createClass\");\n  var _createClass = _interopDefault(_babelRuntimeHelpersCreateClass);\n  var MediaCacheLRU = /*#__PURE__*/function () {\n    function MediaCacheLRU() {\n      var maxBytes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 75 * 1024 * 1024;\n      (0, _classCallCheck.default)(this, MediaCacheLRU);\n      this.maxBytes = maxBytes;\n      this.map = new Map();\n      this.total = 0;\n    }\n    return (0, _createClass.default)(MediaCacheLRU, [{\n      key: \"sizeBytes\",\n      get: function () {\n        return this.total;\n      }\n    }, {\n      key: \"get\",\n      value: function get(key) {\n        var e = this.map.get(key);\n        if (!e) return null;\n        e.ts = Date.now();\n        return e.uri;\n      }\n    }, {\n      key: \"set\",\n      value: function set(key, uri) {\n        var bytes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1_000_000;\n        // default 1MB if unknown\n        var existed = this.map.get(key);\n        if (existed) {\n          this.total -= existed.bytes;\n          this.map.delete(key);\n        }\n        var e = {\n          key,\n          uri,\n          bytes,\n          ts: Date.now()\n        };\n        this.map.set(key, e);\n        this.total += e.bytes;\n        this.evict();\n      }\n    }, {\n      key: \"evict\",\n      value: function evict() {\n        if (this.total <= this.maxBytes) return;\n        var arr = Array.from(this.map.values()).sort((a, b) => a.ts - b.ts); // oldest first\n        for (var e of arr) {\n          this.map.delete(e.key);\n          this.total -= e.bytes;\n          if (this.total <= this.maxBytes) break;\n        }\n      }\n    }]);\n  }();\n});","lineCount":76,"map":[[12,2,3,0,"Object"],[12,8,3,0],[12,9,3,0,"defineProperty"],[12,23,3,0],[12,24,3,0,"exports"],[12,31,3,0],[13,4,3,0,"enumerable"],[13,14,3,0],[14,4,3,0,"get"],[14,7,3,0],[14,18,3,0,"get"],[14,19,3,0],[15,6,3,0],[15,13,3,0,"MediaCacheLRU"],[15,26,3,0],[16,4,3,0],[17,2,3,0],[18,2,38,1],[18,6,38,1,"_babelRuntimeHelpersClassCallCheck"],[18,40,38,1],[18,43,38,1,"require"],[18,50,38,1],[18,51,38,1,"_dependencyMap"],[18,65,38,1],[19,2,38,1],[19,6,38,1,"_classCallCheck"],[19,21,38,1],[19,24,38,1,"_interopDefault"],[19,39,38,1],[19,40,38,1,"_babelRuntimeHelpersClassCallCheck"],[19,74,38,1],[20,2,38,1],[20,6,38,1,"_babelRuntimeHelpersCreateClass"],[20,37,38,1],[20,40,38,1,"require"],[20,47,38,1],[20,48,38,1,"_dependencyMap"],[20,62,38,1],[21,2,38,1],[21,6,38,1,"_createClass"],[21,18,38,1],[21,21,38,1,"_interopDefault"],[21,36,38,1],[21,37,38,1,"_babelRuntimeHelpersCreateClass"],[21,68,38,1],[22,2,38,1],[22,6,3,13,"MediaCacheLRU"],[22,19,3,26],[23,4,6,2],[23,13,6,2,"MediaCacheLRU"],[23,27,6,2],[23,29,6,51],[24,6,6,51],[24,10,6,22,"maxBytes"],[24,18,6,30],[24,21,6,30,"arguments"],[24,30,6,30],[24,31,6,30,"length"],[24,37,6,30],[24,45,6,30,"arguments"],[24,54,6,30],[24,62,6,30,"undefined"],[24,71,6,30],[24,74,6,30,"arguments"],[24,83,6,30],[24,89,6,33],[24,91,6,35],[24,94,6,38],[24,98,6,42],[24,101,6,45],[24,105,6,49],[25,6,6,49],[25,10,6,49,"_classCallCheck"],[25,25,6,49],[25,26,6,49,"default"],[25,33,6,49],[25,41,6,49,"MediaCacheLRU"],[25,54,6,49],[26,6,6,49],[26,11,6,22,"maxBytes"],[26,19,6,30],[26,22,6,22,"maxBytes"],[26,30,6,30],[27,6,6,30],[27,11,4,10,"map"],[27,14,4,13],[27,17,4,16],[27,21,4,20,"Map"],[27,24,4,23],[27,25,4,39],[27,26,4,40],[28,6,4,40],[28,11,5,10,"total"],[28,16,5,15],[28,19,5,18],[28,20,5,19],[29,4,6,52],[30,4,6,53],[30,15,6,53,"_createClass"],[30,27,6,53],[30,28,6,53,"default"],[30,35,6,53],[30,37,6,53,"MediaCacheLRU"],[30,50,6,53],[31,6,6,53,"key"],[31,9,6,53],[32,6,6,53,"get"],[32,9,6,53],[32,11,8,2],[32,20,8,2,"get"],[32,21,8,2],[32,23,8,18],[33,8,8,20],[33,15,8,27],[33,19,8,31],[33,20,8,32,"total"],[33,25,8,37],[34,6,8,39],[35,4,8,40],[36,6,8,40,"key"],[36,9,8,40],[37,6,8,40,"value"],[37,11,8,40],[37,13,10,2],[37,22,10,2,"get"],[37,25,10,5,"get"],[37,26,10,6,"key"],[37,29,10,17],[37,31,10,19],[38,8,11,4],[38,12,11,10,"e"],[38,13,11,11],[38,16,11,14],[38,20,11,18],[38,21,11,19,"map"],[38,24,11,22],[38,25,11,23,"get"],[38,28,11,26],[38,29,11,27,"key"],[38,32,11,30],[38,33,11,31],[39,8,12,4],[39,12,12,8],[39,13,12,9,"e"],[39,14,12,10],[39,16,12,12],[39,23,12,19],[39,27,12,23],[40,8,13,4,"e"],[40,9,13,5],[40,10,13,6,"ts"],[40,12,13,8],[40,15,13,11,"Date"],[40,19,13,15],[40,20,13,16,"now"],[40,23,13,19],[40,24,13,20],[40,25,13,21],[41,8,14,4],[41,15,14,11,"e"],[41,16,14,12],[41,17,14,13,"uri"],[41,20,14,16],[42,6,15,2],[43,4,15,3],[44,6,15,3,"key"],[44,9,15,3],[45,6,15,3,"value"],[45,11,15,3],[45,13,17,2],[45,22,17,2,"set"],[45,25,17,5,"set"],[45,26,17,6,"key"],[45,29,17,17],[45,31,17,19,"uri"],[45,34,17,30],[45,36,17,51],[46,8,17,51],[46,12,17,32,"bytes"],[46,17,17,37],[46,20,17,37,"arguments"],[46,29,17,37],[46,30,17,37,"length"],[46,36,17,37],[46,44,17,37,"arguments"],[46,53,17,37],[46,61,17,37,"undefined"],[46,70,17,37],[46,73,17,37,"arguments"],[46,82,17,37],[46,88,17,40],[46,97,17,49],[47,8,17,53],[48,8,18,4],[48,12,18,10,"existed"],[48,19,18,17],[48,22,18,20],[48,26,18,24],[48,27,18,25,"map"],[48,30,18,28],[48,31,18,29,"get"],[48,34,18,32],[48,35,18,33,"key"],[48,38,18,36],[48,39,18,37],[49,8,19,4],[49,12,19,8,"existed"],[49,19,19,15],[49,21,19,17],[50,10,20,6],[50,14,20,10],[50,15,20,11,"total"],[50,20,20,16],[50,24,20,20,"existed"],[50,31,20,27],[50,32,20,28,"bytes"],[50,37,20,33],[51,10,21,6],[51,14,21,10],[51,15,21,11,"map"],[51,18,21,14],[51,19,21,15,"delete"],[51,25,21,21],[51,26,21,22,"key"],[51,29,21,25],[51,30,21,26],[52,8,22,4],[53,8,23,4],[53,12,23,10,"e"],[53,13,23,18],[53,16,23,21],[54,10,23,23,"key"],[54,13,23,26],[55,10,23,28,"uri"],[55,13,23,31],[56,10,23,33,"bytes"],[56,15,23,38],[57,10,23,40,"ts"],[57,12,23,42],[57,14,23,44,"Date"],[57,18,23,48],[57,19,23,49,"now"],[57,22,23,52],[57,23,23,53],[58,8,23,55],[58,9,23,56],[59,8,24,4],[59,12,24,8],[59,13,24,9,"map"],[59,16,24,12],[59,17,24,13,"set"],[59,20,24,16],[59,21,24,17,"key"],[59,24,24,20],[59,26,24,22,"e"],[59,27,24,23],[59,28,24,24],[60,8,25,4],[60,12,25,8],[60,13,25,9,"total"],[60,18,25,14],[60,22,25,18,"e"],[60,23,25,19],[60,24,25,20,"bytes"],[60,29,25,25],[61,8,26,4],[61,12,26,8],[61,13,26,9,"evict"],[61,18,26,14],[61,19,26,15],[61,20,26,16],[62,6,27,2],[63,4,27,3],[64,6,27,3,"key"],[64,9,27,3],[65,6,27,3,"value"],[65,11,27,3],[65,13,29,2],[65,22,29,2,"evict"],[65,27,29,7,"evict"],[65,28,29,7],[65,30,29,10],[66,8,30,4],[66,12,30,8],[66,16,30,12],[66,17,30,13,"total"],[66,22,30,18],[66,26,30,22],[66,30,30,26],[66,31,30,27,"maxBytes"],[66,39,30,35],[66,41,30,37],[67,8,31,4],[67,12,31,10,"arr"],[67,15,31,13],[67,18,31,16,"Array"],[67,23,31,21],[67,24,31,22,"from"],[67,28,31,26],[67,29,31,27],[67,33,31,31],[67,34,31,32,"map"],[67,37,31,35],[67,38,31,36,"values"],[67,44,31,42],[67,45,31,43],[67,46,31,44],[67,47,31,45],[67,48,31,46,"sort"],[67,52,31,50],[67,53,31,51],[67,54,31,52,"a"],[67,55,31,53],[67,57,31,55,"b"],[67,58,31,56],[67,63,31,61,"a"],[67,64,31,62],[67,65,31,63,"ts"],[67,67,31,65],[67,70,31,68,"b"],[67,71,31,69],[67,72,31,70,"ts"],[67,74,31,72],[67,75,31,73],[67,76,31,74],[67,77,31,75],[68,8,32,4],[68,13,32,9],[68,17,32,15,"e"],[68,18,32,16],[68,22,32,20,"arr"],[68,25,32,23],[68,27,32,25],[69,10,33,6],[69,14,33,10],[69,15,33,11,"map"],[69,18,33,14],[69,19,33,15,"delete"],[69,25,33,21],[69,26,33,22,"e"],[69,27,33,23],[69,28,33,24,"key"],[69,31,33,27],[69,32,33,28],[70,10,34,6],[70,14,34,10],[70,15,34,11,"total"],[70,20,34,16],[70,24,34,20,"e"],[70,25,34,21],[70,26,34,22,"bytes"],[70,31,34,27],[71,10,35,6],[71,14,35,10],[71,18,35,14],[71,19,35,15,"total"],[71,24,35,20],[71,28,35,24],[71,32,35,28],[71,33,35,29,"maxBytes"],[71,41,35,37],[71,43,35,39],[72,8,36,4],[73,6,37,2],[74,4,37,3],[75,2,37,3],[76,0,37,3],[76,3]],"functionMap":{"names":["<global>","MediaCacheLRU","constructor","get__sizeBytes","get","set","evict","Array.from.sort$argument_0"],"mappings":"AAA;OCE;ECG,mDD;EEE,sCF;EGE;GHK;EIE;GJU;EKE;mDCE,qBD;GLM"},"hasCjsExports":false},"type":"js/module"}]}